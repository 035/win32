---
Description: This Windows Search reference section consists of protocol handler interfaces.
ms.assetid: 7089a107-ef3c-4215-aa75-3107815807a1
title: Protocol Handlers Interfaces
ms.date: 05/31/2018
ms.topic: article
ms.author: windowssdkdev
ms.prod: windows
ms.technology: desktop
---

# Protocol Handlers Interfaces

This Windows Search reference section consists of protocol handler interfaces.

## 

## In this section



| Topic                                                                                   | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|-----------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**IItemPropertyBag**](iitempropertybag.md)<br/>                                 | Defines methods to obtain information about the properties of a search item. This interface is supported only on Windows XP and Windows Server 2003, and should no longer be used.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [**IOpLockStatus**](/windows/win32/Searchapi/nn-searchapi-ioplockstatus?branch=master)<br/>                               | Provides methods to check the opportunistic lock that is used by Microsoft Windows Desktop Search (WDS) on items while indexing. If another process locks the file in an incompatible manner, WDS will lose its lock and allow the other process to have the file. This mechanism allows WDS to run in the background. Consequently, WDS needs to check its locks to ensure another process has not taken precedence while WDS indexes the item. <br/> A third-party [**IUrlAccessor**](/windows/win32/Searchapi/nn-searchapi-iurlaccessor?branch=master) object can implement this interface if the underlying data store provides a mechanism to track concurrent access to items. If this interface is exposed by **IUrlAccessor**, WDS will check the [**IOpLockStatus**](/windows/win32/Searchapi/nn-searchapi-ioplockstatus?branch=master) while indexing items from that store. <br/> |
| [**IProtocolHandlerServices**](/windows/win32/Searchapi/?branch=master)<br/>         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [**IProtocolHandlerSite**](/windows/win32/Searchapi/nn-searchapi-iprotocolhandlersite?branch=master)<br/>                 | Provides methods for a protocol handler's [**IUrlAccessor**](/windows/win32/Searchapi/nn-searchapi-iurlaccessor?branch=master) object to query the Filter Daemon for the appropriate filter for the URL item. <br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [**ISearchProtocol**](/windows/win32/Searchapi/nn-searchapi-isearchprotocol?branch=master)<br/>                           | Provides methods for invoking, initializing, and managing [**IUrlAccessor**](/windows/win32/Searchapi/nn-searchapi-iurlaccessor?branch=master) objects. Methods in this interface are called by the protocol host when processing URLs from the gatherer. <br/> The protocol handler implements the protocol for accessing a content source in its native format. Use this interface to implement a custom protocol handler to expand the data sources that can be indexed. <br/>                                                                                                                                                                                                                                                                                                                                                                    |
| [**ISearchProtocol2**](/windows/win32/Searchapi/nn-searchapi-isearchprotocol2?branch=master)<br/>                         | Provides methods for invoking, initializing, and managing [**IUrlAccessor**](/windows/win32/Searchapi/nn-searchapi-iurlaccessor?branch=master) objects. Methods in this interface are called by the protocol host when processing URLs from the gatherer. <br/> The protocol handler implements the protocol for accessing a content source in its native format. Use this interface to implement a custom protocol handler to expand the data sources that can be indexed. <br/>                                                                                                                                                                                                                                                                                                                                                                    |
| [**ISearchProtocolThreadContext**](/windows/win32/Searchapi/nn-searchapi-isearchprotocolthreadcontext?branch=master)<br/> | This optional interface enables the protocol handler to perform an action on the thread used for filtering in the protocol host. When the protocol host starts, it first initializes all the protocol handlers, and then it creates the filtering thread(s). The methods on this interface enable protocol handlers to manage their resources that are used by a filtering thread.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [**ISearchProtocolUI**](-search-isearchprotocolui.md)<br/>                       | Provides a method for invoking [**ISearchItem**](-search-isearchitem.md) objects. Methods in this interface are called by the protocol host when processing URLs from the gatherer. The protocol handler implements the protocol for accessing a content source in its native format, and this interface implements a custom protocol handler to expand the data sources that can be indexed.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                |
| [**IUrlAccessor**](/windows/win32/Searchapi/nn-searchapi-iurlaccessor?branch=master)<br/>                                 | Provides methods for processing an individual item in a content source whose URL is provided by the gatherer to the filter host. <br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| [**IUrlAccessor2**](/windows/win32/Searchapi/nn-searchapi-iurlaccessor2?branch=master)<br/>                               | Extends functionality of the [**IUrlAccessor**](/windows/win32/Searchapi/nn-searchapi-iurlaccessor?branch=master) interface.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [**IUrlAccessor3**](/windows/win32/Searchapi/nn-searchapi-iurlaccessor3?branch=master)<br/>                               | Extends the functionality of the [**IUrlAccessor2**](/windows/win32/Searchapi/nn-searchapi-iurlaccessor2?branch=master) interface with the [**IUrlAccessor3::GetImpersonationSidBlobs**](/windows/win32/Searchapi/nf-searchapi-iurlaccessor3-getimpersonationsidblobs?branch=master) method to identify user security identifiers (SIDs) for a specified URL.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| [**IUrlAccessor4**](/windows/win32/Searchapi/nn-searchapi-iurlaccessor4?branch=master)<br/>                               | Extends the functionality of the [**IUrlAccessor3**](/windows/win32/Searchapi/nn-searchapi-iurlaccessor3?branch=master) interface with the [**IUrlAccessor4::ShouldIndexItemContent**](/windows/win32/Searchapi/nf-searchapi-iurlaccessor4-shouldindexitemcontent?branch=master) method that identifies whether the content of the item should be indexed. <br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |



 

 

 




