---
Description: 'This section describes the Windows Property System functions.'
ms.assetid: 'ce8336cd-d9aa-4b93-ab47-30edd7518dab'
title: Functions
---

# Functions

This section describes the Windows Property System functions.



| Topic                                                                                                | Contents                                                                                                                                                                                                                                                                                                                                                                                                     |
|------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [PROPVARIANT and VARIANT Functions](shell.functions_propvarutil)                                     | This section describes a set of Windows Property System conversion and helper functions used with [**PROPVARIANT**](stg.propvariant) and [**VARIANT**](e305240e-9e11-4006-98cc-26f4932d2118) types.                                                                                                                                                                                                          |
| [Property Bag Functions](property-bag-functions.md)                                                 | This section describes a set of Windows helper functions used with [**IPropertyBag**](_inet_IPropertyBag_Interface_cpp) objects.                                                                                                                                                                                                                                                                             |
| [**PifMgr\_CloseProperties**](pifmgr-closeproperties.md)                                            | Closes application properties that were opened with [**PifMgr\_OpenProperties**](pifmgr-openproperties.md).<br/>                                                                                                                                                                                                                                                                                      |
| [**PifMgr\_GetProperties**](pifmgr-getproperties.md)                                                | Returns a specified block of data from a .pif file.<br/>                                                                                                                                                                                                                                                                                                                                               |
| [**PifMgr\_OpenProperties**](pifmgr-openproperties.md)                                              | Opens the .pif file associated with a Microsoft MS-DOS application, and returns a handle to the application's properties.<br/>                                                                                                                                                                                                                                                                         |
| [**PifMgr\_SetProperties**](pifmgr-setproperties.md)                                                | Assigns values to a block of data from a .pif file.<br/>                                                                                                                                                                                                                                                                                                                                               |
| [**PSCoerceToCanonicalValue**](shell.PSCoerceToCanonicalValue)                                       | Converts the value of a property to the canonical value, according to the property description.<br/>                                                                                                                                                                                                                                                                                                   |
| [**PSCreateAdapterFromPropertyStore**](shell.PSCreateAdapterFromPropertyStore)                       | Creates an adapter from an [**IPropertyStore**](shell.IPropertyStore).<br/>                                                                                                                                                                                                                                                                                                                            |
| [**PSCreateDelayedMultiplexPropertyStore**](shell.PSCreateDelayedMultiplexPropertyStore)             | Creates a read-only, delayed-binding property store that contains multiple property stores.<br/>                                                                                                                                                                                                                                                                                                       |
| [**PSCreateMemoryPropertyStore**](shell.PSCreateMemoryPropertyStore)                                 | Creates an in-memory property store.<br/>                                                                                                                                                                                                                                                                                                                                                              |
| [**PSCreateMultiplexPropertyStore**](shell.PSCreateMultiplexPropertyStore)                           | Creates a read-only property store that contains multiple property stores, each of which must support either [**IPropertyStore**](shell.IPropertyStore) or [**IPropertySetStorage**](stg.ipropertysetstorage).<br/>                                                                                                                                                                                    |
| [**PSCreatePropertyChangeArray**](shell.PSCreatePropertyChangeArray)                                 | Creates a container for a set of [**IPropertyChange**](shell.IPropertyChange) objects. This container can be used with [**IFileOperation**](shell.IFileOperation) to apply a set of property changes to a set of files.<br/>                                                                                                                                                                           |
| [**PSCreatePropertyStoreFromObject**](shell.PSCreatePropertyStoreFromObject)                         | Accepts the [**IUnknown**](com.iunknown) interface of an object that supports [**IPropertyStore**](shell.IPropertyStore) or [**IPropertySetStorage**](stg.ipropertysetstorage). If the object supports **IPropertySetStorage**, it is wrapped so that it supports **IPropertyStore**.<br/>                                                                                                             |
| [**PSCreatePropertyStoreFromPropertySetStorage**](shell.PSCreatePropertyStoreFromPropertySetStorage) | Wraps an [**IPropertySetStorage**](stg.ipropertysetstorage) interface in an [**IPropertyStore**](shell.IPropertyStore) interface.<br/>                                                                                                                                                                                                                                                                 |
| [**PSCreateSimplePropertyChange**](shell.PSCreateSimplePropertyChange)                               | Creates a simple property change.<br/>                                                                                                                                                                                                                                                                                                                                                                 |
| [**PSEnumeratePropertyDescriptions**](shell.PSEnumeratePropertyDescriptions)                         | A wrapper API that calls the schema subsystem's [**IPropertySystem::EnumeratePropertyDescriptions**](shell.IPropertySystem_EnumeratePropertyDescriptions). This function retrieves an instance of the subsystem object that implements [**IPropertyDescriptionList**](shell.IPropertyDescriptionList), to obtain either the entire list or a partial list of property descriptions in the system.<br/> |
| [**PSFormatForDisplay**](shell.PSFormatForDisplay)                                                   | Gets a formatted, Unicode string representation of a property value stored in a [**PROPVARIANT**](stg.propvariant) structure. The caller is responsible for allocating the output buffer.<br/>                                                                                                                                                                                                         |
| [**PSFormatForDisplayAlloc**](shell.PSFormatForDisplayAlloc)                                         | Gets a formatted, Unicode string representation of a property value stored in a [**PROPVARIANT**](stg.propvariant) structure. This function allocates memory for the output string.<br/>                                                                                                                                                                                                               |
| [**PSFormatPropertyValue**](shell.PSFormatPropertyValue)                                             | Gets a formatted, Unicode string representation of a property value stored in a property store. This function allocates memory for the output string.<br/>                                                                                                                                                                                                                                             |
| [**PSGetImageReferenceForValue**](shell.PSGetImageReferenceForValue)                                 | Gets an instance of a property description interface for a specified property.<br/>                                                                                                                                                                                                                                                                                                                    |
| [**PSGetItemPropertyHandler**](shell.PSGetItemPropertyHandler)                                       | Retrieves a property handler for a Shell item.<br/>                                                                                                                                                                                                                                                                                                                                                    |
| [**PSGetItemPropertyHandlerWithCreateObject**](shell.PSGetItemPropertyHandlerWithCreateObject)       | Retrieves a property handler for a Shell item.<br/>                                                                                                                                                                                                                                                                                                                                                    |
| [**PSGetNamedPropertyFromPropertyStorage**](shell.PSGetNamedPropertyFromPropertyStorage)             | Gets a value from serialized property storage by property name.<br/>                                                                                                                                                                                                                                                                                                                                   |
| [**PSGetNameFromPropertyKey**](shell.PSGetNameFromPropertyKey)                                       | Retrieves the canonical name of the property, given its [**PROPERTYKEY**](shell.PROPERTYKEY).<br/>                                                                                                                                                                                                                                                                                                     |
| [**PSGetPropertyDescription**](shell.PSGetPropertyDescription)                                       | Gets an instance of a property description interface for a property specified by a [**PROPERTYKEY**](shell.PROPERTYKEY) structure.<br/>                                                                                                                                                                                                                                                                |
| [**PSGetPropertyDescriptionByName**](shell.PSGetPropertyDescriptionByName)                           | Gets an instance of a property description interface for a specified property name.<br/>                                                                                                                                                                                                                                                                                                               |
| [**PSGetPropertyDescriptionListFromString**](shell.PSGetPropertyDescriptionListFromString)           | Gets an instance of a property description list interface for a specified property list.<br/>                                                                                                                                                                                                                                                                                                          |
| [**PSGetPropertyFromPropertyStorage**](shell.PSGetPropertyFromPropertyStorage)                       | Gets the value of a property as stored in serialized property storage.<br/>                                                                                                                                                                                                                                                                                                                            |
| [**PSGetPropertyKeyFromName**](shell.PSGetPropertyKeyFromName)                                       | Gets the property key for a canonical property name.<br/>                                                                                                                                                                                                                                                                                                                                              |
| [**PSGetPropertySystem**](shell.PSGetPropertySystem)                                                 | Gets an instance of the subsystem object that implements [**IPropertySystem**](shell.IPropertySystem).<br/>                                                                                                                                                                                                                                                                                            |
| [**PSGetPropertyValue**](shell.PSGetPropertyValue)                                                   | Gets a property value from a property store.<br/>                                                                                                                                                                                                                                                                                                                                                      |
| [**PSLookupPropertyHandlerCLSID**](shell.PSLookupPropertyHandlerCLSID)                               | Gets the class identifier (CLSID) of a per-computer, registered file property handler.<br/>                                                                                                                                                                                                                                                                                                            |
| [**PSPropertyBag\_Delete**](shell.PSPropertyBag_Delete)                                              | Deletes a property from a property bag.<br/>                                                                                                                                                                                                                                                                                                                                                           |
| [**PSPropertyBag\_ReadBOOL**](shell.PSPropertyBag_ReadBOOL)                                          | Reads the **BOOL** data value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                    |
| [**PSPropertyBag\_ReadBSTR**](shell.PSPropertyBag_ReadBSTR)                                          | Reads a **BSTR** data value from a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                    |
| [**PSPropertyBag\_ReadDWORD**](shell.PSPropertyBag_ReadDWORD)                                        | Reads a **DWORD** data value from property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                     |
| [**PSPropertyBag\_ReadGUID**](shell.PSPropertyBag_ReadGUID)                                          | Reads the GUID data value from a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                      |
| [**PSPropertyBag\_ReadInt**](shell.PSPropertyBag_ReadInt)                                            | Reads a **int** data value from a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                     |
| [**PSPropertyBag\_ReadLONG**](shell.PSPropertyBag_ReadLONG)                                          | Reads a **long** data value from a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                    |
| [**PSPropertyBag\_ReadPOINTL**](shell.PSPropertyBag_ReadPOINTL)                                      | Retrieves the coordinates stored in a property contained in a specified property bag.<br/>                                                                                                                                                                                                                                                                                                             |
| [**PSPropertyBag\_ReadPOINTS**](shell.PSPropertyBag_ReadPOINTS)                                      | Retrieves the coordinates stored in a property contained in a specified property bag.<br/>                                                                                                                                                                                                                                                                                                             |
| [**PSPropertyBag\_ReadPropertyKey**](shell.PSPropertyBag_ReadPropertyKey)                            | Reads the property key of a property in a specified property bag.<br/>                                                                                                                                                                                                                                                                                                                                 |
| [**PSPropertyBag\_ReadRECTL**](shell.PSPropertyBag_ReadRECTL)                                        | Retrieves the coordinates of a rectangle stored in a property contained in a specified property bag.<br/>                                                                                                                                                                                                                                                                                              |
| [**PSPropertyBag\_ReadSHORT**](shell.PSPropertyBag_ReadSHORT)                                        | Reads the **SHORT** data value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                   |
| [**PSPropertyBag\_ReadStr**](shell.PSPropertyBag_ReadStr)                                            | Reads the string data value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                      |
| [**PSPropertyBag\_ReadStrAlloc**](shell.PSPropertyBag_ReadStrAlloc)                                  | Retrieves details about the allocation or releasing of memory for a string that is stored in a property contained in a specified property bag.<br/>                                                                                                                                                                                                                                                    |
| [**PSPropertyBag\_ReadStream**](shell.PSPropertyBag_ReadStream)                                      | Reads the data stream stored in a given property contained in a specified property bag.<br/>                                                                                                                                                                                                                                                                                                           |
| [**PSPropertyBag\_ReadType**](shell.PSPropertyBag_ReadType)                                          | Reads the type of data value of a property that is stored in a property bag.<br/>                                                                                                                                                                                                                                                                                                                      |
| [**PSPropertyBag\_ReadULONGLONG**](shell.PSPropertyBag_ReadULONGLONG)                                | Reads a **ULONGLONG** data value from a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                               |
| [**PSPropertyBag\_ReadUnknown**](shell.PSPropertyBag_ReadUnknown)                                    | Reads a given property of an unknown data value in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                |
| [**PSPropertyBag\_WriteBOOL**](shell.PSPropertyBag_WriteBOOL)                                        | Sets the **BOOL** value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                          |
| [**PSPropertyBag\_WriteBSTR**](shell.PSPropertyBag_WriteBSTR)                                        | Sets the **BSTR** value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                          |
| [**PSPropertyBag\_WriteDWORD**](shell.PSPropertyBag_WriteDWORD)                                      | Sets the **DWORD** value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                         |
| [**PSPropertyBag\_WriteGUID**](shell.PSPropertyBag_WriteGUID)                                        | Sets the GUID value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                              |
| [**PSPropertyBag\_WriteInt**](shell.PSPropertyBag_WriteInt)                                          | Sets the **int** value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                           |
| [**PSPropertyBag\_WriteLONG**](shell.PSPropertyBag_WriteLONG)                                        | Sets the **long** value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                          |
| [**PSPropertyBag\_WritePOINTL**](shell.PSPropertyBag_WritePOINTL)                                    | Stores the coordinates of a point in a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                |
| [**PSPropertyBag\_WritePOINTS**](shell.PSPropertyBag_WritePOINTS)                                    | Stores the coordinates of a point in a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                |
| [**PSPropertyBag\_WritePropertyKey**](shell.PSPropertyBag_WritePropertyKey)                          | Sets the property key value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                      |
| [**PSPropertyBag\_WriteRECTL**](shell.PSPropertyBag_WriteRECTL)                                      | Stores the coordinates of a rectangle in a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                            |
| [**PSPropertyBag\_WriteSHORT**](shell.PSPropertyBag_WriteSHORT)                                      | Sets the **SHORT** value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                         |
| [**PSPropertyBag\_WriteStr**](shell.PSPropertyBag_WriteStr)                                          | Sets the string value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                            |
| [**PSPropertyBag\_WriteStream**](shell.PSPropertyBag_WriteStream)                                    | Writes a data stream to a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                             |
| [**PSPropertyBag\_WriteULONGLONG**](shell.PSPropertyBag_WriteULONGLONG)                              | Sets the **ULONGLONG** value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                     |
| [**PSPropertyBag\_WriteUnknown**](shell.PSPropertyBag_WriteUnknown)                                  | Reads a property of an unknown data value in a property bag. <br/>                                                                                                                                                                                                                                                                                                                                     |
| [**PSPropertyKeyFromString**](shell.PSPropertyKeyFromString)                                         | Converts a string to a [**PROPERTYKEY**](shell.PROPERTYKEY) structure.<br/>                                                                                                                                                                                                                                                                                                                            |
| [**PSRefreshPropertySchema**](shell.PSRefreshPropertySchema)                                         | Not currently supported.<br/>                                                                                                                                                                                                                                                                                                                                                                          |
| [**PSRegisterPropertySchema**](shell.PSRegisterPropertySchema)                                       | Informs the schema subsystem of the addition of a property description schema file.<br/>                                                                                                                                                                                                                                                                                                               |
| [**PSSetPropertyValue**](shell.PSSetPropertyValue)                                                   | Sets the value of a property in a property store.<br/>                                                                                                                                                                                                                                                                                                                                                 |
| [**PSStringFromPropertyKey**](shell.PSStringFromPropertyKey)                                         | Creates a string that identifies a property from that property's key.<br/>                                                                                                                                                                                                                                                                                                                             |
| [**PSUnregisterPropertySchema**](shell.PSUnregisterPropertySchema)                                   | Informs the schema subsystem of the removal of a property description schema file.<br/>                                                                                                                                                                                                                                                                                                                |
| [**SHAddDefaultPropertiesByExt**](shadddefaultpropertiesbyext.md)                                   | Adds default properties to the property store as registered for the specified file extension.<br/>                                                                                                                                                                                                                                                                                                     |
| [**SHGetPropertyStoreForWindow**](shgetpropertystoreforwindow.md)                                   | Retrieves an object that represents a specific window's collection of properties, which allows those properties to be queried or set.<br/>                                                                                                                                                                                                                                                             |
| [**SHGetPropertyStoreFromIDList**](shgetpropertystorefromidlist.md)                                 | Retrieves an object that supports [**IPropertyStore**](shell.IPropertyStore) or related interfaces from a pointer to an item identifier list (PIDL).<br/>                                                                                                                                                                                                                                              |
| [**SHGetPropertyStoreFromParsingName**](shgetpropertystorefromparsingname.md)                       | Returns a property store for an item, given a path or parsing name.<br/>                                                                                                                                                                                                                                                                                                                               |
| [**SHPropStgCreate**](shpropstgcreate.md)                                                           | Ensures proper handling of code page retrieval or assignment for the requested property set operation.<br/>                                                                                                                                                                                                                                                                                            |
| [**SHPropStgReadMultiple**](shpropstgreadmultiple.md)                                               | Wraps the [**IPropertyStorage::ReadMultiple**](stg.ipropertystorage_readmultiple) function to ensure that ANSI and Unicode translations are handled properly for deprecated property sets.<br/>                                                                                                                                                                                                        |
| [**SHPropStgWriteMultiple**](shpropstgwritemultiple.md)                                             | Wraps the [**IPropertyStorage::WriteMultiple**](stg.ipropertystorage_writemultiple) function to ensure that ANSI and Unicode translations are handled properly for deprecated property sets.<br/>                                                                                                                                                                                                      |



 

## Related topics

<dl> <dt>

[Windows Properties](props.md)
</dt> <dt>

[Property Description Schema](property-description-schema.md)
</dt> <dt>

[Property Sets](property-sets.md)
</dt> <dt>

[Interfaces](interfaces.md)
</dt> <dt>

[Structures](structures.md)
</dt> <dt>

[Constants, Enumerations, and Flags](constants--enumerations--and-flags.md)
</dt> </dl>

 

 




