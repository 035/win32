---
Description: This section describes the Windows Property System functions.
ms.assetid: ce8336cd-d9aa-4b93-ab47-30edd7518dab
title: Functions
ms.technology: desktop
ms.prod: windows
ms.author: windowssdkdev
ms.topic: article
ms.date: 05/31/2018
---

# Functions

This section describes the Windows Property System functions.



| Topic                                                                                                | Contents                                                                                                                                                                                                                                                                                                                                                                                                     |
|------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [PROPVARIANT and VARIANT Functions](https://www.bing.com/search?q=PROPVARIANT and VARIANT Functions)                                     | This section describes a set of Windows Property System conversion and helper functions used with [**PROPVARIANT**](https://msdn.microsoft.com/windows/desktop/e86cc279-826d-4767-8d96-fc8280060ea1) and [**VARIANT**](https://msdn.microsoft.com/windows/desktop/e305240e-9e11-4006-98cc-26f4932d2118) types.                                                                                                                                                                                                          |
| [Property Bag Functions](property-bag-functions.md)                                                 | This section describes a set of Windows helper functions used with [**IPropertyBag**](https://www.bing.com/search?q=**IPropertyBag**) objects.                                                                                                                                                                                                                                                                             |
| [**PifMgr\_CloseProperties**](/windows/desktop/api/Shlobj_core/nf-shlobj_core-pifmgr_closeproperties)                                            | Closes application properties that were opened with [**PifMgr\_OpenProperties**](/windows/desktop/api/Shlobj_core/nf-shlobj_core-pifmgr_openproperties).<br/>                                                                                                                                                                                                                                                                                      |
| [**PifMgr\_GetProperties**](/windows/desktop/api/Shlobj_core/nf-shlobj_core-pifmgr_getproperties)                                                | Returns a specified block of data from a .pif file.<br/>                                                                                                                                                                                                                                                                                                                                               |
| [**PifMgr\_OpenProperties**](/windows/desktop/api/Shlobj_core/nf-shlobj_core-pifmgr_openproperties)                                              | Opens the .pif file associated with a Microsoft MS-DOS application, and returns a handle to the application's properties.<br/>                                                                                                                                                                                                                                                                         |
| [**PifMgr\_SetProperties**](/windows/desktop/api/Shlobj_core/nf-shlobj_core-pifmgr_setproperties)                                                | Assigns values to a block of data from a .pif file.<br/>                                                                                                                                                                                                                                                                                                                                               |
| [**PSCoerceToCanonicalValue**](https://www.bing.com/search?q=**PSCoerceToCanonicalValue**)                                       | Converts the value of a property to the canonical value, according to the property description.<br/>                                                                                                                                                                                                                                                                                                   |
| [**PSCreateAdapterFromPropertyStore**](https://www.bing.com/search?q=**PSCreateAdapterFromPropertyStore**)                       | Creates an adapter from an [**IPropertyStore**](https://www.bing.com/search?q=**IPropertyStore**).<br/>                                                                                                                                                                                                                                                                                                                            |
| [**PSCreateDelayedMultiplexPropertyStore**](https://www.bing.com/search?q=**PSCreateDelayedMultiplexPropertyStore**)             | Creates a read-only, delayed-binding property store that contains multiple property stores.<br/>                                                                                                                                                                                                                                                                                                       |
| [**PSCreateMemoryPropertyStore**](https://www.bing.com/search?q=**PSCreateMemoryPropertyStore**)                                 | Creates an in-memory property store.<br/>                                                                                                                                                                                                                                                                                                                                                              |
| [**PSCreateMultiplexPropertyStore**](https://www.bing.com/search?q=**PSCreateMultiplexPropertyStore**)                           | Creates a read-only property store that contains multiple property stores, each of which must support either [**IPropertyStore**](https://www.bing.com/search?q=**IPropertyStore**) or [**IPropertySetStorage**](https://msdn.microsoft.com/windows/desktop/0ea3e1e0-c135-4138-81e4-f72412fc3128).<br/>                                                                                                                                                                                    |
| [**PSCreatePropertyChangeArray**](https://www.bing.com/search?q=**PSCreatePropertyChangeArray**)                                 | Creates a container for a set of [**IPropertyChange**](https://www.bing.com/search?q=**IPropertyChange**) objects. This container can be used with [**IFileOperation**](https://msdn.microsoft.com/windows/desktop/6596607e-0699-4eb6-b0d6-7cc2e5eb49c7) to apply a set of property changes to a set of files.<br/>                                                                                                                                                                           |
| [**PSCreatePropertyStoreFromObject**](https://www.bing.com/search?q=**PSCreatePropertyStoreFromObject**)                         | Accepts the [**IUnknown**](https://msdn.microsoft.com/windows/desktop/33f1d79a-33fc-4ce5-a372-e08bda378332) interface of an object that supports [**IPropertyStore**](https://www.bing.com/search?q=**IPropertyStore**) or [**IPropertySetStorage**](https://msdn.microsoft.com/windows/desktop/0ea3e1e0-c135-4138-81e4-f72412fc3128). If the object supports **IPropertySetStorage**, it is wrapped so that it supports **IPropertyStore**.<br/>                                                                                                             |
| [**PSCreatePropertyStoreFromPropertySetStorage**](https://www.bing.com/search?q=**PSCreatePropertyStoreFromPropertySetStorage**) | Wraps an [**IPropertySetStorage**](https://msdn.microsoft.com/windows/desktop/0ea3e1e0-c135-4138-81e4-f72412fc3128) interface in an [**IPropertyStore**](https://www.bing.com/search?q=**IPropertyStore**) interface.<br/>                                                                                                                                                                                                                                                                 |
| [**PSCreateSimplePropertyChange**](https://www.bing.com/search?q=**PSCreateSimplePropertyChange**)                               | Creates a simple property change.<br/>                                                                                                                                                                                                                                                                                                                                                                 |
| [**PSEnumeratePropertyDescriptions**](https://www.bing.com/search?q=**PSEnumeratePropertyDescriptions**)                         | A wrapper API that calls the schema subsystem's [**IPropertySystem::EnumeratePropertyDescriptions**](https://www.bing.com/search?q=**IPropertySystem::EnumeratePropertyDescriptions**). This function retrieves an instance of the subsystem object that implements [**IPropertyDescriptionList**](https://www.bing.com/search?q=**IPropertyDescriptionList**), to obtain either the entire list or a partial list of property descriptions in the system.<br/> |
| [**PSFormatForDisplay**](https://www.bing.com/search?q=**PSFormatForDisplay**)                                                   | Gets a formatted, Unicode string representation of a property value stored in a [**PROPVARIANT**](https://msdn.microsoft.com/windows/desktop/e86cc279-826d-4767-8d96-fc8280060ea1) structure. The caller is responsible for allocating the output buffer.<br/>                                                                                                                                                                                                         |
| [**PSFormatForDisplayAlloc**](https://www.bing.com/search?q=**PSFormatForDisplayAlloc**)                                         | Gets a formatted, Unicode string representation of a property value stored in a [**PROPVARIANT**](https://msdn.microsoft.com/windows/desktop/e86cc279-826d-4767-8d96-fc8280060ea1) structure. This function allocates memory for the output string.<br/>                                                                                                                                                                                                               |
| [**PSFormatPropertyValue**](https://www.bing.com/search?q=**PSFormatPropertyValue**)                                             | Gets a formatted, Unicode string representation of a property value stored in a property store. This function allocates memory for the output string.<br/>                                                                                                                                                                                                                                             |
| [**PSGetImageReferenceForValue**](https://www.bing.com/search?q=**PSGetImageReferenceForValue**)                                 | Gets an instance of a property description interface for a specified property.<br/>                                                                                                                                                                                                                                                                                                                    |
| [**PSGetItemPropertyHandler**](https://www.bing.com/search?q=**PSGetItemPropertyHandler**)                                       | Retrieves a property handler for a Shell item.<br/>                                                                                                                                                                                                                                                                                                                                                    |
| [**PSGetItemPropertyHandlerWithCreateObject**](https://www.bing.com/search?q=**PSGetItemPropertyHandlerWithCreateObject**)       | Retrieves a property handler for a Shell item.<br/>                                                                                                                                                                                                                                                                                                                                                    |
| [**PSGetNamedPropertyFromPropertyStorage**](https://www.bing.com/search?q=**PSGetNamedPropertyFromPropertyStorage**)             | Gets a value from serialized property storage by property name.<br/>                                                                                                                                                                                                                                                                                                                                   |
| [**PSGetNameFromPropertyKey**](https://www.bing.com/search?q=**PSGetNameFromPropertyKey**)                                       | Retrieves the canonical name of the property, given its [**PROPERTYKEY**](https://www.bing.com/search?q=**PROPERTYKEY**).<br/>                                                                                                                                                                                                                                                                                                     |
| [**PSGetPropertyDescription**](https://www.bing.com/search?q=**PSGetPropertyDescription**)                                       | Gets an instance of a property description interface for a property specified by a [**PROPERTYKEY**](https://www.bing.com/search?q=**PROPERTYKEY**) structure.<br/>                                                                                                                                                                                                                                                                |
| [**PSGetPropertyDescriptionByName**](https://www.bing.com/search?q=**PSGetPropertyDescriptionByName**)                           | Gets an instance of a property description interface for a specified property name.<br/>                                                                                                                                                                                                                                                                                                               |
| [**PSGetPropertyDescriptionListFromString**](https://www.bing.com/search?q=**PSGetPropertyDescriptionListFromString**)           | Gets an instance of a property description list interface for a specified property list.<br/>                                                                                                                                                                                                                                                                                                          |
| [**PSGetPropertyFromPropertyStorage**](https://www.bing.com/search?q=**PSGetPropertyFromPropertyStorage**)                       | Gets the value of a property as stored in serialized property storage.<br/>                                                                                                                                                                                                                                                                                                                            |
| [**PSGetPropertyKeyFromName**](https://www.bing.com/search?q=**PSGetPropertyKeyFromName**)                                       | Gets the property key for a canonical property name.<br/>                                                                                                                                                                                                                                                                                                                                              |
| [**PSGetPropertySystem**](https://www.bing.com/search?q=**PSGetPropertySystem**)                                                 | Gets an instance of the subsystem object that implements [**IPropertySystem**](https://www.bing.com/search?q=**IPropertySystem**).<br/>                                                                                                                                                                                                                                                                                            |
| [**PSGetPropertyValue**](https://www.bing.com/search?q=**PSGetPropertyValue**)                                                   | Gets a property value from a property store.<br/>                                                                                                                                                                                                                                                                                                                                                      |
| [**PSLookupPropertyHandlerCLSID**](https://www.bing.com/search?q=**PSLookupPropertyHandlerCLSID**)                               | Gets the class identifier (CLSID) of a per-computer, registered file property handler.<br/>                                                                                                                                                                                                                                                                                                            |
| [**PSPropertyBag\_Delete**](https://www.bing.com/search?q=**PSPropertyBag\_Delete**)                                              | Deletes a property from a property bag.<br/>                                                                                                                                                                                                                                                                                                                                                           |
| [**PSPropertyBag\_ReadBOOL**](https://www.bing.com/search?q=**PSPropertyBag\_ReadBOOL**)                                          | Reads the **BOOL** data value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                    |
| [**PSPropertyBag\_ReadBSTR**](https://www.bing.com/search?q=**PSPropertyBag\_ReadBSTR**)                                          | Reads a **BSTR** data value from a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                    |
| [**PSPropertyBag\_ReadDWORD**](https://www.bing.com/search?q=**PSPropertyBag\_ReadDWORD**)                                        | Reads a **DWORD** data value from property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                     |
| [**PSPropertyBag\_ReadGUID**](https://www.bing.com/search?q=**PSPropertyBag\_ReadGUID**)                                          | Reads the GUID data value from a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                      |
| [**PSPropertyBag\_ReadInt**](https://www.bing.com/search?q=**PSPropertyBag\_ReadInt**)                                            | Reads a **int** data value from a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                     |
| [**PSPropertyBag\_ReadLONG**](https://www.bing.com/search?q=**PSPropertyBag\_ReadLONG**)                                          | Reads a **long** data value from a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                    |
| [**PSPropertyBag\_ReadPOINTL**](https://www.bing.com/search?q=**PSPropertyBag\_ReadPOINTL**)                                      | Retrieves the coordinates stored in a property contained in a specified property bag.<br/>                                                                                                                                                                                                                                                                                                             |
| [**PSPropertyBag\_ReadPOINTS**](https://www.bing.com/search?q=**PSPropertyBag\_ReadPOINTS**)                                      | Retrieves the coordinates stored in a property contained in a specified property bag.<br/>                                                                                                                                                                                                                                                                                                             |
| [**PSPropertyBag\_ReadPropertyKey**](https://www.bing.com/search?q=**PSPropertyBag\_ReadPropertyKey**)                            | Reads the property key of a property in a specified property bag.<br/>                                                                                                                                                                                                                                                                                                                                 |
| [**PSPropertyBag\_ReadRECTL**](https://www.bing.com/search?q=**PSPropertyBag\_ReadRECTL**)                                        | Retrieves the coordinates of a rectangle stored in a property contained in a specified property bag.<br/>                                                                                                                                                                                                                                                                                              |
| [**PSPropertyBag\_ReadSHORT**](https://www.bing.com/search?q=**PSPropertyBag\_ReadSHORT**)                                        | Reads the **SHORT** data value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                   |
| [**PSPropertyBag\_ReadStr**](https://www.bing.com/search?q=**PSPropertyBag\_ReadStr**)                                            | Reads the string data value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                      |
| [**PSPropertyBag\_ReadStrAlloc**](https://www.bing.com/search?q=**PSPropertyBag\_ReadStrAlloc**)                                  | Retrieves details about the allocation or releasing of memory for a string that is stored in a property contained in a specified property bag.<br/>                                                                                                                                                                                                                                                    |
| [**PSPropertyBag\_ReadStream**](https://www.bing.com/search?q=**PSPropertyBag\_ReadStream**)                                      | Reads the data stream stored in a given property contained in a specified property bag.<br/>                                                                                                                                                                                                                                                                                                           |
| [**PSPropertyBag\_ReadType**](https://www.bing.com/search?q=**PSPropertyBag\_ReadType**)                                          | Reads the type of data value of a property that is stored in a property bag.<br/>                                                                                                                                                                                                                                                                                                                      |
| [**PSPropertyBag\_ReadULONGLONG**](https://www.bing.com/search?q=**PSPropertyBag\_ReadULONGLONG**)                                | Reads a **ULONGLONG** data value from a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                               |
| [**PSPropertyBag\_ReadUnknown**](https://www.bing.com/search?q=**PSPropertyBag\_ReadUnknown**)                                    | Reads a given property of an unknown data value in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                |
| [**PSPropertyBag\_WriteBOOL**](https://www.bing.com/search?q=**PSPropertyBag\_WriteBOOL**)                                        | Sets the **BOOL** value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                          |
| [**PSPropertyBag\_WriteBSTR**](https://www.bing.com/search?q=**PSPropertyBag\_WriteBSTR**)                                        | Sets the **BSTR** value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                          |
| [**PSPropertyBag\_WriteDWORD**](https://www.bing.com/search?q=**PSPropertyBag\_WriteDWORD**)                                      | Sets the **DWORD** value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                         |
| [**PSPropertyBag\_WriteGUID**](https://www.bing.com/search?q=**PSPropertyBag\_WriteGUID**)                                        | Sets the GUID value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                              |
| [**PSPropertyBag\_WriteInt**](https://www.bing.com/search?q=**PSPropertyBag\_WriteInt**)                                          | Sets the **int** value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                           |
| [**PSPropertyBag\_WriteLONG**](https://www.bing.com/search?q=**PSPropertyBag\_WriteLONG**)                                        | Sets the **long** value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                          |
| [**PSPropertyBag\_WritePOINTL**](https://www.bing.com/search?q=**PSPropertyBag\_WritePOINTL**)                                    | Stores the coordinates of a point in a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                |
| [**PSPropertyBag\_WritePOINTS**](https://www.bing.com/search?q=**PSPropertyBag\_WritePOINTS**)                                    | Stores the coordinates of a point in a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                |
| [**PSPropertyBag\_WritePropertyKey**](https://www.bing.com/search?q=**PSPropertyBag\_WritePropertyKey**)                          | Sets the property key value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                      |
| [**PSPropertyBag\_WriteRECTL**](https://www.bing.com/search?q=**PSPropertyBag\_WriteRECTL**)                                      | Stores the coordinates of a rectangle in a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                            |
| [**PSPropertyBag\_WriteSHORT**](https://www.bing.com/search?q=**PSPropertyBag\_WriteSHORT**)                                      | Sets the **SHORT** value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                         |
| [**PSPropertyBag\_WriteStr**](https://www.bing.com/search?q=**PSPropertyBag\_WriteStr**)                                          | Sets the string value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                            |
| [**PSPropertyBag\_WriteStream**](https://www.bing.com/search?q=**PSPropertyBag\_WriteStream**)                                    | Writes a data stream to a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                             |
| [**PSPropertyBag\_WriteULONGLONG**](https://www.bing.com/search?q=**PSPropertyBag\_WriteULONGLONG**)                              | Sets the **ULONGLONG** value of a property in a property bag.<br/>                                                                                                                                                                                                                                                                                                                                     |
| [**PSPropertyBag\_WriteUnknown**](https://www.bing.com/search?q=**PSPropertyBag\_WriteUnknown**)                                  | Reads a property of an unknown data value in a property bag. <br/>                                                                                                                                                                                                                                                                                                                                     |
| [**PSPropertyKeyFromString**](https://www.bing.com/search?q=**PSPropertyKeyFromString**)                                         | Converts a string to a [**PROPERTYKEY**](https://www.bing.com/search?q=**PROPERTYKEY**) structure.<br/>                                                                                                                                                                                                                                                                                                                            |
| [**PSRefreshPropertySchema**](https://www.bing.com/search?q=**PSRefreshPropertySchema**)                                         | Not currently supported.<br/>                                                                                                                                                                                                                                                                                                                                                                          |
| [**PSRegisterPropertySchema**](https://www.bing.com/search?q=**PSRegisterPropertySchema**)                                       | Informs the schema subsystem of the addition of a property description schema file.<br/>                                                                                                                                                                                                                                                                                                               |
| [**PSSetPropertyValue**](https://www.bing.com/search?q=**PSSetPropertyValue**)                                                   | Sets the value of a property in a property store.<br/>                                                                                                                                                                                                                                                                                                                                                 |
| [**PSStringFromPropertyKey**](https://www.bing.com/search?q=**PSStringFromPropertyKey**)                                         | Creates a string that identifies a property from that property's key.<br/>                                                                                                                                                                                                                                                                                                                             |
| [**PSUnregisterPropertySchema**](https://www.bing.com/search?q=**PSUnregisterPropertySchema**)                                   | Informs the schema subsystem of the removal of a property description schema file.<br/>                                                                                                                                                                                                                                                                                                                |
| [**SHAddDefaultPropertiesByExt**](/windows/desktop/api/Shobjidl/nf-shobjidl-shadddefaultpropertiesbyext)                                   | Adds default properties to the property store as registered for the specified file extension.<br/>                                                                                                                                                                                                                                                                                                     |
| [**SHGetPropertyStoreForWindow**](/windows/desktop/api/Shellapi/nf-shellapi-shgetpropertystoreforwindow)                                   | Retrieves an object that represents a specific window's collection of properties, which allows those properties to be queried or set.<br/>                                                                                                                                                                                                                                                             |
| [**SHGetPropertyStoreFromIDList**](/windows/desktop/api/Shobjidl_core/nf-shobjidl_core-shgetpropertystorefromidlist)                                 | Retrieves an object that supports [**IPropertyStore**](https://www.bing.com/search?q=**IPropertyStore**) or related interfaces from a pointer to an item identifier list (PIDL).<br/>                                                                                                                                                                                                                                              |
| [**SHGetPropertyStoreFromParsingName**](/windows/desktop/api/Shobjidl_core/nf-shobjidl_core-shgetpropertystorefromparsingname)                       | Returns a property store for an item, given a path or parsing name.<br/>                                                                                                                                                                                                                                                                                                                               |
| [**SHPropStgCreate**](/windows/desktop/api/Shlobj_core/nf-shlobj_core-shpropstgcreate)                                                           | Ensures proper handling of code page retrieval or assignment for the requested property set operation.<br/>                                                                                                                                                                                                                                                                                            |
| [**SHPropStgReadMultiple**](/windows/desktop/api/Shlobj_core/nf-shlobj_core-shpropstgreadmultiple)                                               | Wraps the [**IPropertyStorage::ReadMultiple**](https://msdn.microsoft.com/windows/desktop/a3d708fe-53af-4f1b-94ac-edc40d59a034) function to ensure that ANSI and Unicode translations are handled properly for deprecated property sets.<br/>                                                                                                                                                                                                        |
| [**SHPropStgWriteMultiple**](/windows/desktop/api/Shlobj_core/nf-shlobj_core-shpropstgwritemultiple)                                             | Wraps the [**IPropertyStorage::WriteMultiple**](https://msdn.microsoft.com/windows/desktop/480a2be3-ccb0-4135-a085-733f6ab48ccd) function to ensure that ANSI and Unicode translations are handled properly for deprecated property sets.<br/>                                                                                                                                                                                                      |



 

## Related topics

<dl> <dt>

[Windows Properties](props.md)
</dt> <dt>

[Property Description Schema](property-description-schema.md)
</dt> <dt>

[Property Sets](property-sets.md)
</dt> <dt>

[Interfaces](interfaces.md)
</dt> <dt>

[Structures](structures.md)
</dt> <dt>

[Constants, Enumerations, and Flags](constants--enumerations--and-flags.md)
</dt> </dl>

 

 




