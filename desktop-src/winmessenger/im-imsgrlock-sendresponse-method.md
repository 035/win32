---
title: IMsgrLock SendResponse method
description: Sends authentication data from a Messenger client to a Messenger service .
ms.assetid: 3c6790d9-9632-432d-b3b5-2d2c1150d61c
keywords:
- SendResponse method Windows Messenger
- SendResponse method Windows Messenger , IMsgrLock interface
- IMsgrLock interface Windows Messenger , SendResponse method
topic_type:
- apiref
api_name:
- IMsgrLock.SendResponse
api_location:
- Msgsc.dll
api_type:
- COM
ms.technology: desktop
ms.prod: windows
ms.author: windowssdkdev
ms.topic: article
ms.date: 05/31/2018
---

# IMsgrLock::SendResponse method

\[**SendResponse** is no longer available for use as of Windows Vista. See [Windows Messenger](im-messenger-entry.md) for more information.\]

Sends authentication data from a Messenger client to a Messenger service .

## Syntax


```C++
HRESULT SendResponse(
  [in] BSTR bstrAppStrId,
  [in] BSTR bstrResponse,
  [in] long lCookie
);
```



## Parameters

<dl> <dt>

*bstrAppStrId* \[in\]
</dt> <dd>

Type: **BSTR**

**BSTR** that identifies the application's ID.

</dd> <dt>

*bstrResponse* \[in\]
</dt> <dd>

Type: **BSTR**

**BSTR** that has been generated by an MD5. See Remarks for more information.

</dd> <dt>

*lCookie* \[in\]
</dt> <dd>

Type: **long**

**LONG** that identifies the transaction session.

</dd> </dl>

## Return value

Type: **HRESULT**

Returns one of the following values.



| Return code                                                                                                    | Description                                                                         |
|----------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------|
| <dl> <dt>**S\_OK**</dt> </dl>                           | The response was sent successfully.<br/>                                      |
| <dl> <dt>**E\_FAIL**</dt> </dl>                         | The response has failed due to a catastrophic error.<br/>                     |
| <dl> <dt>**E\_INVALIDARG**</dt> </dl>                   | One of the parameters passed to the method was not valid.<br/>                |
| <dl> <dt>**MSGR\_E\_API\_NOTINITIALIZED**</dt> </dl>    | The Messenger client lock and key mechanism is not initialized.<br/>          |
| <dl> <dt>**MSGR\_E\_API\_LOCKED**</dt> </dl>            | The Messenger service  API is locked.<br/>                                    |
| <dl> <dt>**MSGR\_E\_API\_PENDING\_UNLOCK**</dt> </dl>   | The application timed out while waiting for the result of the challenge.<br/> |
| <dl> <dt>**MSGR\_E\_API\_UNLOCK\_FAILED**</dt> </dl>    | The application response to the challenge failed.<br/>                        |
| <dl> <dt>**MSGR\_E\_API\_ALREADY\_UNLOCKED**</dt> </dl> | The Messenger service  API is already unlocked.<br/>                          |



 

## Remarks

The [**OnLockChallenge**](im-dmessengerprivateevents-onlockchallenge.md) event is fired when a Messenger service responds to a Messenger client request challenge. This event returns two parameters. The first parameter is a **LONG** that identifies a cookie. This cookie is passed to the Messenger service when the Messenger client initiates a challenge request with the [**RequestChallenge**](im-imsgrlock-requestchallenge-method.md) method. The second parameter is a **BSTR**, which is generated by the Messenger service . For more information, see the overview on the [Messenger Lock and Key API](im-lock-and-key-ovw.md).

The following table lists the error codes returned by this method.



| Error Code                                   | Meaning                                                                  |
|----------------------------------------------|--------------------------------------------------------------------------|
| 0x80000003                                   | One of the parameters passed to the method was not valid.                |
| MSGR\_E\_API\_NOTINITIALIZED (0x81000751)    | The Messenger client lock and key mechanism is not initialized.          |
| MSGR\_E\_API\_LOCKED (0x81000752)            | The Messenger service  API is locked.                                    |
| MSGR\_E\_API\_UNLOCK\_FAILED (0x81000753)    | The application response to the challenge failed.                        |
| MSGR\_E\_API\_ALREADY\_UNLOCKED (0x81000754) | The Messenger service  API is already unlocked.                          |
| MSGR\_E\_API\_PENDING\_UNLOCK (0x81000755)   | The application timed out while waiting for the result of the challenge. |
| 0x80004005                                   | The response has failed due to a catastrophic error.                     |



 

## Requirements



|                                     |                                                                                         |
|-------------------------------------|-----------------------------------------------------------------------------------------|
| Minimum supported client<br/> | Windows XP \[desktop apps only\]<br/>                                             |
| Minimum supported server<br/> | Windows Server 2003 \[desktop apps only\]<br/>                                    |
| End of client support<br/>    | Windows XP<br/>                                                                   |
| End of server support<br/>    | Windows Server 2003<br/>                                                          |
| Product<br/>                  | Messenger 4.5<br/>                                                                |
| Header<br/>                   | <dl> <dt>Msgrpriv.h</dt> </dl>   |
| IDL<br/>                      | <dl> <dt>Msgrpriv.idl</dt> </dl> |
| DLL<br/>                      | <dl> <dt>Msgsc.dll</dt> </dl>    |



## See also

<dl> <dt>

[**IMsgrLock**](im-imsgrlock.md)
</dt> <dt>

[**RequestChallenge**](im-imsgrlock-requestchallenge-method.md)
</dt> <dt>

[**OnLockChallenge**](im-dmessengerprivateevents-onlockchallenge.md)
</dt> <dt>

[Messenger Session Invite and Messenger Private APIs](im-session-invite-ovw.md)
</dt> </dl>

 

 





