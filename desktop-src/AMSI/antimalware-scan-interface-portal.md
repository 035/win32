---
title: Antimalware Scan Interface (AMSI)
description: The Antimalware Scan Interface (AMSI) is a versatile interface standard that allows your applications and services to integrate with any antimalware product that's present on a machine.
ms.assetid: 3b7473eb-e4a8-4280-87b7-926bd68fd645
ms.topic: article
ms.date: 02/27/2019
---

# Antimalware Scan Interface (AMSI)

## Purpose

The Windows Antimalware Scan Interface (AMSI) is a versatile interface standard that allows your applications and services to integrate with any antimalware product that's present on a machine. AMSI provides enhanced malware protection for your end-users and their data, applications, and workloads.

AMSI is agnostic of antimalware vendor; it's designed to allow for the most common malware scanning and protection techniques provided by today's antimalware products that can be integrated into applications. It supports a calling structure allowing for file and memory or stream scanning, content source URL/IP reputation checks, and other techniques.

AMSI also supports the notion of a session so that antimalware vendors can correlate different scan requests. For instance, the different fragments of a malicious payload can be associated to reach a more informed decision, which would be much harder to reach just by looking at those fragments in isolation.

## Windows components that integrate with AMSI

The AMSI feature is integrated into these components of Windows 10.

- User Account Control, or UAC (elevation of EXE, COM, MSI, or ActiveX installation)
- PowerShell (scripts, interactive use, and dynamic code evaluation)
- Windows Script Host (wscript.exe and cscript.exe)
- JavaScript and VBScript
- Office VBA macros

## Developer audience

The Antimalware Scan Interface is designed for use by two groups of developers.

- App developers who want to make requests to antimalware products from within their apps.
- Third-party creators of antimalware products who want their products to offer the best features to apps.

## Registering as a provider 

> [!NOTE]
> Starting in Windows 10, version 1809 (10.0; Build 17763), your AMSI DLL must be signed, otherwise it won't be loaded.

After Windows 10, version 1709 (the Fall 2017 Creators' Update), an AMSI provider DLL may not work if it depends upon other DLLs in its path to be loaded at the same time. To prevent DLL hijacking, we recommend that a provider DLL load its dependencies explicitly (with a full path) using secure [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibraryw) calls, or equivalent. We recommend this instead of relying on the  **LoadLibrary** search behavior.

## AMSI use and sample code

See the following resources.

- [IAmsiStream interface sample application](https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/AmsiStream)
- [IAntimalwareProvider interface sample application](https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/AmsiProvider)

## In this section

| Topic | Description |
|-|-|
| [How AMSI helps you defend against malware](how-amsi-helps.md) | As an application developer, you can actively participate in malware defense. Specifically, you can help protect your customers from dynamic script-based malware, and from non-traditional avenues of cyberattack. |
| [Antimalware Scan Interface Reference](antimalware-scan-interface-reference.md) | Enumerations, COM interfaces, and other programming elements of the AMSI API. |
