---
title: Eventing
description: A hosted service must implement the IUPnPEventSource interface if it has evented state variables.
ms.assetid: 7558496d-c909-4602-bfaa-d21108392fed
ms.date: 05/31/2018
ms.topic: article
ms.author: windowssdkdev
ms.prod: windows
ms.technology: desktop
---

# Eventing

A hosted service must implement the [**IUPnPEventSource**](/windows/win32/Upnphost/nn-upnphost-iupnpeventsource?branch=master) interface if it has evented state variables. This interface has two methods: [**Advise**](/windows/win32/Upnphost/nf-upnphost-iupnpeventsource-advise?branch=master) and [**Unadvise**](/windows/win32/Upnphost/nf-upnphost-iupnpeventsource-unadvise?branch=master). This interface provides a mechanism for the device host to subscribe to event notifications generated by the hosted service. There will be no more than one event sink registered at a time.

A hosted service must implement the [**Advise**](/windows/win32/Upnphost/nf-upnphost-iupnpeventsource-advise?branch=master) method by holding a reference to the [**IUPnPEventSink**](/windows/win32/Upnphost/nn-upnphost-iupnpeventsink?branch=master) interface, which was passed as a parameter. If the interface is found, the **Advise** method holds a reference to that interface until [**Unadvise**](/windows/win32/Upnphost/nf-upnphost-iupnpeventsource-unadvise?branch=master) is invoked, or until the hosted service object is removed. **Advise** is called only once.

To remove the subscription, the device host invokes [**Unadvise**](/windows/win32/Upnphost/nf-upnphost-iupnpeventsource-unadvise?branch=master) and passes in the object pointer used when it called [**Advise**](/windows/win32/Upnphost/nf-upnphost-iupnpeventsource-advise?branch=master). The hosted service removes the subscription if the pointer is the same as the one passed to **Advise**.

When a state variable's value changes, the hosted service must signal that an event has occurred. The services does this by invoking the [**IUPnPEventSink::OnStateChanged**](/windows/win32/Upnphost/nf-upnphost-iupnpeventsink-onstatechanged?branch=master) method.

When the device host no longer needs to receive notifications from the hosted service, it invokes [**IUPnPEventSource::Unadvise**](/windows/win32/Upnphost/nf-upnphost-iupnpeventsource-unadvise?branch=master), passing in the same object pointer that it received from [**Advise**](/windows/win32/Upnphost/nf-upnphost-iupnpeventsource-advise?branch=master). The device host invokes this method when the device is no longer going to be on the network.

 

 




