---
Description: The IPrintOemUI2::DocumentEvent method allows a UI plug-in to replace the core driver UI module's default implementation of the DrvDocumentEvent DDI.
ms.assetid: c98d1510-7db8-4fd6-a95f-1906f553d1c5
title: IPrintOemUI2::DocumentEvent method
ms.technology: desktop
ms.prod: windows
ms.author: windowssdkdev
ms.topic: article
ms.date: 05/31/2018
---

# IPrintOemUI2::DocumentEvent method

The `IPrintOemUI2::DocumentEvent` method allows a UI plug-in to replace the core driver UI module's default implementation of the [**DrvDocumentEvent**](drvdocumentevent.md) DDI.

## Syntax


```C++
HRESULT DocumentEvent(
   HANDLE hPrinter,
   HDC    hdc,
   INT    iEsc,
   ULONG  cbIn,
   PVOID  pvIn,
   ULONG  cbOut,
   PVOID  pvOut,
   PINT   piResult
);
```



## Parameters

<dl> <dt>

*hPrinter* 
</dt> <dd>

Caller-supplied printer handle.

</dd> <dt>

*hdc* 
</dt> <dd>

Caller-supplied device context handle, generated by a **CreateDC** call. This is zero if *iEsc* is DOCUMENTEVENT\_CREATEDCPRE.

</dd> <dt>

*iEsc* 
</dt> <dd>

Caller-supplied escape code identifying the event to be handled. This parameter can be one of the following integer constants:



| Escape Code                                                                             | Meaning                                                                                                                                                                                                                                                                                                           |
|-----------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| DOCUMENTEVENT\_ABORTDOC<br/>                                                      | GDI is about to process a call to its **AbortDoc** function.<br/>                                                                                                                                                                                                                                           |
| DOCUMENTEVENT\_CREATEDCPOST<br/>                                                  | GDI has just processed a call to its **CreateDC** or **CreateIC** function.<br/> This escape code should not be used unless there has been a previous call to **DrvDocumentEvent** with *iEsc* set to DOCUMENTEVENT\_CREATEDCPRE.<br/>                                                                |
| DOCUMENTEVENT\_CREATEDCPRE<br/>                                                   | GDI is about to process a call to its **CreateDC** or **CreateIC** function.<br/>                                                                                                                                                                                                                           |
| DOCUMENTEVENT\_DELETEDC<br/>                                                      | GDI is about to process a call to its **DeleteDC** function.<br/>                                                                                                                                                                                                                                           |
| DOCUMENTEVENT\_ENDDOCPOST<br/>                                                    | GDI has just processed a call to its **EndDoc** function.<br/>                                                                                                                                                                                                                                              |
| DOCUMENTEVENT\_ENDDOCPRE <br/> or<br/> DOCUMENTEVENT\_ENDDOC<br/>     | GDI is about to process a call to its **EndDoc** function.<br/>                                                                                                                                                                                                                                             |
| DOCUMENTEVENT\_ENDPAGE<br/>                                                       | GDI is about to process a call to its **EndPage** function.<br/>                                                                                                                                                                                                                                            |
| DOCUMENTEVENT\_ESCAPE<br/>                                                        | GDI is about to process a call to its **ExtEscape** function.<br/>                                                                                                                                                                                                                                          |
| DOCUMENTEVENT\_QUERYFILTER<br/>                                                   | The DOCUMENTEVENT\_QUERYFILTER event represents an opportunity for the spooler to query the driver for a list of the DOCUMENTEVENT\_*XXX* events to which the driver will respond. This event is issued just prior to a call to **DrvDocumentEvent** that passes the DOCUMENTEVENT\_CREATEDCPRE event.<br/> |
| DOCUMENTEVENT\_RESETDCPOST<br/>                                                   | GDI has just processed a call to its **ResetDC** function.<br/> This escape code should not be used unless there has been a previous call to **DrvDocumentEvent** with *iEsc* set to DOCUMENTEVENT\_RESETDCPRE.<br/>                                                                                  |
| DOCUMENTEVENT\_RESETDCPRE<br/>                                                    | GDI is about to process a call to its **ResetDC** function.<br/>                                                                                                                                                                                                                                            |
| DOCUMENTEVENT\_STARTDOCPOST<br/>                                                  | GDI has just processed a call to its **StartDoc** function.<br/>                                                                                                                                                                                                                                            |
| DOCUMENTEVENT\_STARTDOCPRE <br/> or<br/> DOCUMENTEVENT\_STARTDOC<br/> | GDI is about to process a call to its **StartDoc** function.<br/>                                                                                                                                                                                                                                           |
| DOCUMENTEVENT\_STARTPAGE<br/>                                                     | GDI is about to process a call to its **StartPage** function.<br/>                                                                                                                                                                                                                                          |



 

</dd> <dt>

*cbIn* 
</dt> <dd>

Caller-supplied size, in bytes, of the buffer pointed to by *pvIn*.

</dd> <dt>

*pvIn* 
</dt> <dd>

Caller-supplied pointer, the use of which is dependent on the value supplied for *iEsc*, as follows:



| *iEsc* Constant                                                                        | *pvIn* Contents                                                                                                                                                                                                                                     |
|----------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| DOCUMENTEVENT\_ABORTDOC<br/>                                                     | Not used.<br/>                                                                                                                                                                                                                                |
| DOCUMENTEVENT\_CREATEDCPOST<br/>                                                 | *pvIn* contains the address of a pointer to the [**DEVMODEW**](https://msdn.microsoft.com/b2369876-9a79-40c8-8d27-c8b9d8e68e6b) structure specified in the *pvOut* parameter in a previous call to this function, for which the *iEsc* parameter was set to DOCUMENTEVENT\_CREATEDCPRE.<br/> |
| DOCUMENTEVENT\_CREATEDCPRE<br/>                                                  | *pvIn* points to a [**DOCEVENT\_CREATEDCPRE**](docevent-createdcpre.md) structure.<br/>                                                                                                                                                      |
| DOCUMENTEVENT\_DELETEDC<br/>                                                     | Not used.<br/>                                                                                                                                                                                                                                |
| DOCUMENTEVENT\_ENDDOCPOST<br/>                                                   | Not used.<br/>                                                                                                                                                                                                                                |
| DOCUMENTEVENT\_ENDDOCPRE <br/> or<br/> DOCUMENTEVENT\_ENDDOC<br/>    | Not used.<br/>                                                                                                                                                                                                                                |
| DOCUMENTEVENT\_ENDPAGE<br/>                                                      | Not used.<br/>                                                                                                                                                                                                                                |
| DOCUMENTEVENT\_ESCAPE<br/>                                                       | *pvIn* points to a [**DOCEVENT\_ESCAPE**](docevent-escape.md) structure.<br/>                                                                                                                                                                |
| DOCUMENTEVENT\_QUERYFILTER<br/>                                                  | Same as for DOCUMENTEVENT\_CREATEDCPRE.<br/>                                                                                                                                                                                                  |
| DOCUMENTEVENT\_RESETDCPOST<br/>                                                  | *pvIn* contains the address of a pointer to the [**DEVMODEW**](https://msdn.microsoft.com/b2369876-9a79-40c8-8d27-c8b9d8e68e6b) structure specified in the *pvOut* parameter in a previous call to this function, for which the *iEsc* parameter was set to DOCUMENTEVENT\_RESETDCPRE.<br/>  |
| DOCUMENTEVENT\_RESETDCPRE<br/>                                                   | *pvIn* contains the address of a pointer to a [**DEVMODEW**](https://msdn.microsoft.com/b2369876-9a79-40c8-8d27-c8b9d8e68e6b) structure supplied by the caller of **ResetDC** (described in the Microsoft Windows SDK documentation).<br/>                                                   |
| DOCUMENTEVENT\_STARTDOCPOST<br/>                                                 | *pvIn* points to a LONG that specifies the print job identifier returned by **StartDoc** (described in the Windows SDK documentation).<br/>                                                                                                   |
| DOCUMENTEVENT\_STARTDOCPRE<br/> or<br/> DOCUMENTEVENT\_STARTDOC<br/> | *pvIn* contains the address of a pointer to a DOCINFO structure supplied by the caller of **StartDoc** (both described in the Windows SDK documentation). <br/>                                                                               |
| DOCUMENTEVENT\_STARTPAGE<br/>                                                    | Not used.<br/>                                                                                                                                                                                                                                |



 

</dd> <dt>

*cbOut* 
</dt> <dd>

<dl> <dt>

<span id="If_iEsc_is_DOCUMENTEVENT_ESCAPE_"></span><span id="if_iesc_is_documentevent_escape_"></span><span id="IF_IESC_IS_DOCUMENTEVENT_ESCAPE_"></span>If *iEsc* is DOCUMENTEVENT\_ESCAPE:
</dt> <dd>

Function-supplied value that is used as the *cbOutput* parameter for **ExtEscape**.

</dd> <dt>

<span id="If_iEsc_is_DOCUMENTEVENT_QUERYFILTER_"></span><span id="if_iesc_is_documentevent_queryfilter_"></span><span id="IF_IESC_IS_DOCUMENTEVENT_QUERYFILTER_"></span>If *iEsc* is DOCUMENTEVENT\_QUERYFILTER:
</dt> <dd>

Caller-supplied size, in bytes, of the buffer pointer to by *pvOut*.

</dd> <dt>

<span id="For_all_other_iEsc_values_"></span><span id="for_all_other_iesc_values_"></span><span id="FOR_ALL_OTHER_IESC_VALUES_"></span>For all other *iEsc* values:
</dt> <dd>

Not used.

</dd> </dl> </dd> <dt>

*pvOut* 
</dt> <dd>

Function-supplied pointer to an output buffer, the use of which is dependent on the value supplied for *iEsc*, as follows. **CreateDC**, **ExtEscape**, and **ResetDC** are described in the Windows SDK documentation.



| *iEsc* Constant                       | *pvOut* Contents                                                                                                                                                                          |
|---------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| DOCUMENTEVENT\_CREATEDCPRE<br/> | Pointer to a driver-supplied DEVMODEW structure, which GDI uses instead of the one supplied by the **CreateDC** caller. (If **NULL**, GDI uses the caller-supplied structure.)<br/> |
| DOCUMENTEVENT\_ESCAPE<br/>      | Buffer pointer that is used as the *lpszOutData* parameter for **ExtEscape**.<br/>                                                                                                  |
| DOCUMENTEVENT\_QUERYFILTER<br/> | Caller-supplied pointer to buffer containing a [**DOCEVENT\_FILTER**](docevent-filter.md) structure.<br/>                                                                          |
| DOCUMENTEVENT\_RESETDCPRE<br/>  | Pointer to a driver-supplied DEVMODEW structure, which GDI uses instead of the one supplied by the **ResetDC** caller. (If **NULL**, GDI uses the caller-supplied structure.)<br/>  |
| All other *iEsc* values<br/>    | Not used.<br/>                                                                                                                                                                      |



 

</dd> <dt>

*piResult* 
</dt> <dd>

Pointer to a memory location that receives one of the following values:



| Return Value                          | Definition                                                                                                                          |
|---------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------|
| DOCUMENTEVENT\_FAILURE<br/>     | The driver supports the escape code identified by *iEsc*, but a failure occurred.<br/>                                        |
| DOCUMENTEVENT\_SUCCESS<br/>     | The driver successfully handled the escape code identified by *iEsc*. Also see the Remarks section for more information.<br/> |
| DOCUMENTEVENT\_UNSUPPORTED<br/> | The driver does not support the escape code identified by *iEsc*.<br/>                                                        |



 

</dd> </dl>

## Return value

This method should return one of the following values. See the Remarks section for more information.



| Return code                                                                               | Description                                               |
|-------------------------------------------------------------------------------------------|-----------------------------------------------------------|
| <dl> <dt>**S\_OK**</dt> </dl>      | The UI plug-in implements this method.<br/>         |
| <dl> <dt>**E\_NOTIMPL**</dt> </dl> | The UI plug-in does not implement this method.<br/> |



 

## Remarks

A user interface plug-in's `IPrintOemUI2::DocumentEvent` method performs the same types of operations as the DrvDocumentEvent DDI that is exported by user-mode printer interface DLLs. For information about document events and how they should be processed, see the description of the [**DrvDocumentEvent**](drvdocumentevent.md) DDI.

If you provide a user interface plug-in, the printer driver's DrvDocumentEvent DDI calls the `IPrintOemUI2::DocumentEvent` method. The DrvDocumentEvent DDI performs its own processing for the specified event, and then calls the `IPrintOemUI2::DocumentEvent` method to handle additional processing of the event.

When this method is called with a value of the *iEsc* parameter of DOCUMENTEVENT\_QUERYFILTER, and returns with \**piResult* == DOCUMENTEVENT\_SUCCESS, the spooler can interpret this value in either of two ways, depending on whether certain members of the [**DOCEVENT\_FILTER**](docevent-filter.md) structure changed values. For more information, see the Remarks section for [**DrvDocumentEvent**](drvdocumentevent.md).

When the DOCUMENTEVENT\_QUERYFILTER event is fired, the core driver calls plug-ins in the order they were installed, until one of them returns S\_OK, or until all of the plug-ins have been called and none of them returned S\_OK. In this way, at most one plug-in is allowed to handle the DOCUMENTEVENT\_QUERYFILTER event, and the filter it specifies is applied to all plug-ins in the plug-in chain.

For a plug-in writer who is implementing the **IPrintOemUI2** interface, but does not need to support the `IPrintOemUI2::DocumentEvent` method, this method should return E\_NOTIMPL for all values of *iEsc*. If you do need to implement this method, it should return S\_OK for all values of *iEsc*. This signals the core driver that this method has handled the relevant event. The core driver uses the value that this method places in *piResult* as the return value for the [**DrvDocumentEvent**](drvdocumentevent.md) DDI.

## Requirements



|                            |                                                                                                            |
|----------------------------|------------------------------------------------------------------------------------------------------------|
| Target platform<br/> | <dl> <dt>Desktop</dt> </dl>                         |
| Header<br/>          | <dl> <dt>Prcomoem.h (include Prcomoem.h)</dt> </dl> |



## See also

<dl> <dt>

[**IPrintOemUI2**](iprintoemui2-interface.md)
</dt> <dt>

[**DrvDocumentEvent**](drvdocumentevent.md)
</dt> <dt>

[**DOCEVENT\_FILTER**](docevent-filter.md)
</dt> <dt>

[**DOCEVENT\_CREATEDCPRE**](docevent-createdcpre.md)
</dt> <dt>

[**DOCEVENT\_ESCAPE**](docevent-escape.md)
</dt> </dl>

 

 

[Send comments about this topic to Microsoft](mailto:wsddocfb@microsoft.com?subject=Documentation%20feedback%20%5Bprint\print%5D:%20IPrintOemUI2::DocumentEvent%20method%20%20RELEASE:%20%285/12/2018%29&body=%0A%0APRIVACY%20STATEMENT%0A%0AWe%20use%20your%20feedback%20to%20improve%20the%20documentation.%20We%20don't%20use%20your%20email%20address%20for%20any%20other%20purpose,%20and%20we'll%20remove%20your%20email%20address%20from%20our%20system%20after%20the%20issue%20that%20you're%20reporting%20is%20fixed.%20While%20we're%20working%20to%20fix%20this%20issue,%20we%20might%20send%20you%20an%20email%20message%20to%20ask%20for%20more%20info.%20Later,%20we%20might%20also%20send%20you%20an%20email%20message%20to%20let%20you%20know%20that%20we've%20addressed%20your%20feedback.%0A%0AFor%20more%20info%20about%20Microsoft's%20privacy%20policy,%20see%20http://privacy.microsoft.com/en-us/default.aspx. "Send comments about this topic to Microsoft")





