---
Description: 'Windows GDI+ exposes a flat API that consists of about 600 functions, which are implemented in Gdiplus.dll and declared in Gdiplusflat.h.'
ms.assetid: '89be396f-7421-4a58-890b-6c7c34fe090c'
title: Matrix Functions
---

# Matrix Functions

Windows GDI+ exposes a flat API that consists of about 600 functions, which are implemented in Gdiplus.dll and declared in Gdiplusflat.h. The functions in the GDI+ flat API are wrapped by a collection of about 40 C++ classes. It is recommended that you do not directly call the functions in the flat API. Whenever you make calls to GDI+, you should do so by calling the methods and functions provided by the C++ wrappers. Microsoft Product Support Services will not provide support for code that calls the flat API directly. For more information on using these wrapper methods, see [GDI+ Flat API](-gdiplus-flatapi-flat.md).

The following flat API functions are wrapped by the [**Matrix**](-gdiplus-class-matrix-class.md) C++ class.

## Matrix Functions and Corresponding Wrapper Methods



| Flat function                                                                                                                     | Wrapper method                                                                                              | Description                                                                                                                                                                                                                                                                                                                                                           |
|-----------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| GpStatus WINGDIPAPI GdipCreateMatrix(GpMatrix \*\*matrix)<br/>                                                              | [**Matrix::Matrix**](-gdiplus-class-matrix-matrix-.md)<br/>                                          | Creates and initializes a [**Matrix::Matrix**](-gdiplus-class-matrix-matrix-.md) object that represents the identity matrix.                                                                                                                                                                                                                                         |
| GpStatus WINGDIPAPI GdipCreateMatrix2(REAL m11, REAL m12, REAL m21, REAL m22, REAL dx, REAL dy, GpMatrix \*\*matrix)<br/>   | [**Matrix::Matrix**](-gdiplus-class-matrix-matrix-m11-m12-m21-m22-dx-dy-.md)                               | Creates and initializes a [**Matrix::Matrix**](-gdiplus-class-matrix-matrix-m11-m12-m21-m22-dx-dy-.md) object based on six numbers that define an affine transformation.                                                                                                                                                                                             |
| GpStatus WINGDIPAPI GdipCreateMatrix3(GDIPCONST GpRectF \*rect, GDIPCONST GpPointF \*dstplg, GpMatrix \*\*matrix)<br/>      | [**Matrix::Matrix**](-gdiplus-class-matrix-matrix-rectf-rect-pointf-dstplg-.md)                            | Creates a [**Matrix::Matrix**](-gdiplus-class-matrix-matrix-rectf-rect-pointf-dstplg-.md) object based on a rectangle and a point.                                                                                                                                                                                                                                   |
| GpStatus WINGDIPAPI GdipCreateMatrix3I(GDIPCONST GpRect \*rect, GDIPCONST GpPoint \*dstplg, GpMatrix \*\*matrix)<br/>       | [**Matrix::Matrix**](-gdiplus-class-matrix-matrix-rect-rect-point-dstplg-.md)                              | Creates a [**Matrix::Matrix**](-gdiplus-class-matrix-matrix-rect-rect-point-dstplg-.md) object based on a rectangle and a point.                                                                                                                                                                                                                                     |
| GpStatus WINGDIPAPI GdipCloneMatrix(GpMatrix \*matrix, GpMatrix \*\*cloneMatrix)<br/>                                       | [**Matrix::Clone**](-gdiplus-class-matrix-clone-.md)<br/>                                            | The [**Matrix::Clone**](-gdiplus-class-matrix-clone-.md) method creates a new [**Matrix**](-gdiplus-class-matrix-class.md) object that is a copy of this **Matrix** object.                                                                                                                                                                                         |
| GpStatus WINGDIPAPI GdipDeleteMatrix(GpMatrix \*matrix)<br/>                                                                | ~Matrix() <br/>                                                                                       | Cleans up resources used by a [**Matrix::Matrix**](-gdiplus-class-matrix-matrix-.md) object.                                                                                                                                                                                                                                                                         |
| GpStatus WINGDIPAPI GdipSetMatrixElements(GpMatrix \*matrix, REAL m11, REAL m12, REAL m21, REAL m22, REAL dx, REAL dy)<br/> | [**Matrix::SetElements**](-gdiplus-class-matrix-setelements-m11-m12-m21-m22-dx-dy-.md)<br/>          | The [**Matrix::SetElements**](-gdiplus-class-matrix-setelements-m11-m12-m21-m22-dx-dy-.md) method sets the elements of this matrix.                                                                                                                                                                                                                                  |
| GpStatus WINGDIPAPI GdipMultiplyMatrix(GpMatrix \*matrix, GpMatrix\* matrix2, GpMatrixOrder order)<br/>                     | [**Matrix::Multiply**](-gdiplus-class-matrix-multiply-matrix-order-.md)<br/>                         | The [**Matrix::Multiply**](-gdiplus-class-matrix-multiply-matrix-order-.md) method updates this matrix with the product of itself and another matrix.                                                                                                                                                                                                                |
| GpStatus WINGDIPAPI GdipTranslateMatrix(GpMatrix \*matrix, REAL offsetX, REAL offsetY, GpMatrixOrder order)<br/>            | [**Matrix::Translate**](-gdiplus-class-matrix-translate-offsetx-offsety-order-.md)<br/>              | The [**Matrix::Translate**](-gdiplus-class-matrix-translate-offsetx-offsety-order-.md) method updates this matrix with the product of itself and a translation matrix.                                                                                                                                                                                               |
| GpStatus WINGDIPAPI GdipScaleMatrix(GpMatrix \*matrix, REAL scaleX, REAL scaleY, GpMatrixOrder order)<br/>                  | [**Matrix::Scale**](-gdiplus-class-matrix-scale-scalex-scaley-order-.md)<br/>                        | The [**Matrix::Scale**](-gdiplus-class-matrix-scale-scalex-scaley-order-.md) method updates this matrix with the product of itself and a scaling matrix.                                                                                                                                                                                                             |
| GpStatus WINGDIPAPI GdipRotateMatrix(GpMatrix \*matrix, REAL angle, GpMatrixOrder order)<br/>                               | [**Matrix::Rotate**](-gdiplus-class-matrix-rotate-angle-order-.md)<br/>                              | The [**Matrix::Rotate**](-gdiplus-class-matrix-rotate-angle-order-.md) method updates this matrix with the product of itself and a rotation matrix.                                                                                                                                                                                                                  |
| GpStatus WINGDIPAPI GdipShearMatrix(GpMatrix \*matrix, REAL shearX, REAL shearY, GpMatrixOrder order)<br/>                  | [**Matrix::Shear**](-gdiplus-class-matrix-shear-shearx-sheary-order-.md)<br/>                        | The [**Matrix::Shear**](-gdiplus-class-matrix-shear-shearx-sheary-order-.md) method updates this matrix with the product of itself and a shearing matrix.                                                                                                                                                                                                            |
| GpStatus WINGDIPAPI GdipInvertMatrix(GpMatrix \*matrix)<br/>                                                                | [**Matrix::Invert**](-gdiplus-class-matrix-invert-.md)<br/>                                          | If this matrix is invertible, the [**Matrix::Invert**](-gdiplus-class-matrix-invert-.md) method replaces the elements of this matrix with the elements of its inverse.                                                                                                                                                                                               |
| GpStatus WINGDIPAPI GdipTransformMatrixPoints(GpMatrix \*matrix, GpPointF \*pts, INT count)<br/>                            | [**Matrix::TransformPoints**](-gdiplus-class-matrix-transformpoints-pointf-pts-int-count-.md)<br/>   | The [**Matrix::TransformPoints**](-gdiplus-class-matrix-transformpoints-pointf-pts-int-count-.md) method multiplies each point in an array by this matrix. Each point is treated as a row matrix. The multiplication is performed with the row matrix on the left and this matrix on the right.                                                                      |
| GpStatus WINGDIPAPI GdipTransformMatrixPointsI(GpMatrix \*matrix, GpPoint \*pts, INT count)<br/>                            | [**Matrix::TransformPoints**](-gdiplus-class-matrix-transformpoints-point-pts-int-count-.md)<br/>    | The [**Matrix::TransformPoints**](-gdiplus-class-matrix-transformpoints-point-pts-int-count-.md) method multiplies each point in an array by this matrix. Each point is treated as a row matrix. The multiplication is performed with the row matrix on the left and this matrix on the right.                                                                       |
| GpStatus WINGDIPAPI GdipVectorTransformMatrixPoints(GpMatrix \*matrix, GpPointF \*pts, INT count)<br/>                      | [**Matrix::TransformVectors**](-gdiplus-class-matrix-transformvectors-pointf-pts-int-count-.md)<br/> | The [**Matrix::TransformVectors**](-gdiplus-class-matrix-transformvectors-pointf-pts-int-count-.md) method multiplies each vector in an array by this matrix. The translation elements of this matrix (third row) are ignored. Each vector is treated as a row matrix. The multiplication is performed with the row matrix on the left and this matrix on the right. |
| GpStatus WINGDIPAPI GdipVectorTransformMatrixPointsI(GpMatrix \*matrix, GpPoint \*pts, INT count)<br/>                      | [**Matrix::TransformVectors**](-gdiplus-class-matrix-transformvectors-point-pts-int-count-.md)<br/>  | The [**Matrix::TransformVectors**](-gdiplus-class-matrix-transformvectors-point-pts-int-count-.md) method multiplies each vector in an array by this matrix. The translation elements of this matrix (third row) are ignored. Each vector is treated as a row matrix. The multiplication is performed with the row matrix on the left and this matrix on the right.  |
| GpStatus WINGDIPAPI GdipGetMatrixElements(GDIPCONST GpMatrix \*matrix, REAL \*matrixOut)<br/>                               | [**Matrix::GetElements**](-gdiplus-class-matrix-getelements-.md)<br/>                                | The [**Matrix::GetElements**](-gdiplus-class-matrix-getelements-.md) method gets the elements of this matrix. The elements are placed in an array in the order m11, m12, m21, m22, m31, m32, where mij denotes the element in row i, column j.                                                                                                                       |
| GpStatus WINGDIPAPI GdipIsMatrixInvertible(GDIPCONST GpMatrix \*matrix, BOOL \*result)<br/>                                 | [**Matrix::IsInvertible**](-gdiplus-class-matrix-isinvertible-.md)<br/>                              | The [**Matrix::IsInvertible**](-gdiplus-class-matrix-isinvertible-.md) method determines whether this matrix is invertible.                                                                                                                                                                                                                                          |
| GpStatus WINGDIPAPI GdipIsMatrixIdentity(GDIPCONST GpMatrix \*matrix, BOOL \*result)<br/>                                   | [**Matrix::IsIdentity**](-gdiplus-class-matrix-isidentity-.md)<br/>                                  | The [**Matrix::IsIdentity**](-gdiplus-class-matrix-isidentity-.md) method determines whether this matrix is the identity matrix.                                                                                                                                                                                                                                     |
| GpStatus WINGDIPAPI GdipIsMatrixEqual(GDIPCONST GpMatrix \*matrix, GDIPCONST GpMatrix \*matrix2, BOOL \*result)<br/>        | [**Matrix::Equals**](-gdiplus-class-matrix-equals-matrix-.md)<br/>                                   | The [**Matrix::Equals**](-gdiplus-class-matrix-equals-matrix-.md) method determines whether the elements of this matrix are equal to the elements of another matrix.                                                                                                                                                                                                 |



 

 

 




