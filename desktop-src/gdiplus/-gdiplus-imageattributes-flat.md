---
Description: Windows GDI+ exposes a flat API that consists of about 600 functions, which are implemented in Gdiplus.dll and declared in Gdiplusflat.h.
ms.assetid: 2564ecc6-4050-4f45-9ff6-4ee3f7b04707
title: ImageAttributes Functions
ms.date: 05/31/2018
ms.topic: article
ms.author: windowssdkdev
ms.prod: windows
ms.technology: desktop
---

# ImageAttributes Functions

Windows GDI+ exposes a flat API that consists of about 600 functions, which are implemented in Gdiplus.dll and declared in Gdiplusflat.h. The functions in the GDI+ flat API are wrapped by a collection of about 40 C++ classes. It is recommended that you do not directly call the functions in the flat API. Whenever you make calls to GDI+, you should do so by calling the methods and functions provided by the C++ wrappers. Microsoft Product Support Services will not provide support for code that calls the flat API directly. For more information on using these wrapper methods, see [GDI+ Flat API](-gdiplus-flatapi-flat.md).

The following flat API functions are wrapped by the [**ImageAttributes**](/windows/win32/gdiplusimageattributes/nl-gdiplusimageattributes-imageattributes?branch=master) C++ class.

## ImageAttributes Functions and Corresponding Wrapper Methods



| Flat function                                                                                                                                                                                                                           | Wrapper method                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Remarks                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| GpStatus WINGDIPAPI GdipCreateImageAttributes(GpImageAttributes \*\*imageattr)<br/>                                                                                                                                               | [**ImageAttributes::ImageAttributes()**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-imageattributes(const imageattributes &)?branch=master)                                                                                                                                                                                                                                                                                                                                                                   | Creates an [**ImageAttributes**](/windows/win32/gdiplusimageattributes/nl-gdiplusimageattributes-imageattributes?branch=master) object.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| GpStatus WINGDIPAPI GdipCloneImageAttributes(GDIPCONST GpImageAttributes \*imageattr, GpImageAttributes \*\*cloneImageattr)<br/>                                                                                                  | [**ImageAttributes\* ImageAttributes::Clone() const**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-clone?branch=master)                                                                                                                                                                                                                                                                                                                                                               | Makes a copy of this [**ImageAttributes**](/windows/win32/gdiplusimageattributes/nl-gdiplusimageattributes-imageattributes?branch=master) object.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| GpStatus WINGDIPAPI GdipDisposeImageAttributes(GpImageAttributes \*imageattr)<br/>                                                                                                                                                | ImageAttributes::~ImageAttributes()                                                                                                                                                                                                                                                                                                                                                                                                                             | Releases resources used by the [**ImageAttributes**](/windows/win32/gdiplusimageattributes/nl-gdiplusimageattributes-imageattributes?branch=master) object.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| GpStatus WINGDIPAPI GdipSetImageAttributesToIdentity(GpImageAttributes \*imageattr, ColorAdjustType type)<br/>                                                                                                                    | [**Status ImageAttributes::SetToIdentity( IN ColorAdjustType type = ColorAdjustTypeDefault )**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-settoidentity?branch=master)                                                                                                                                                                                                                                                                                                         | Sets the color-adjustment matrix of a specified category to identity matrix.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| GpStatus WINGDIPAPI GdipResetImageAttributes(GpImageAttributes \*imageattr, ColorAdjustType type)<br/>                                                                                                                            | [**Status ImageAttributes::Reset( IN ColorAdjustType type = ColorAdjustTypeDefault )**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-reset?branch=master)                                                                                                                                                                                                                                                                                                                         | Sets the color-adjustment matrix of a specified category to identity matrix.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| GpStatus WINGDIPAPI GdipSetImageAttributesColorMatrix(GpImageAttributes \*imageattr, ColorAdjustType type, BOOL enableFlag, GDIPCONST ColorMatrix\* colorMatrix, GDIPCONST ColorMatrix\* grayMatrix, ColorMatrixFlags flags)<br/> | [**Status ImageAttributes::SetColorMatrix( IN const ColorMatrix \*colorMatrix, IN ColorMatrixFlags mode = ColorMatrixFlagsDefault, IN ColorAdjustType type = ColorAdjustTypeDefault )**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-setcolormatrix?branch=master)[**Status ImageAttributes::ClearColorMatrix(IN ColorAdjustType type = ColorAdjustTypeDefault)**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-clearcolormatrix?branch=master)                                   | Sets the color-adjustment matrix for a specified category. The *enableFlag* parameter in the flat function is a Boolean value that specifies whether a separate color adjustment is enabled for the category specified by the *type* parameter. [**ImageAttributes::SetColorMatrix**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-setcolormatrix?branch=master) sets *enableFlag* to **TRUE**, and [**ImageAttributes::ClearColorMatrix**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-clearcolormatrix?branch=master) sets *enableFlag* to **FALSE**.<br/> Clears the color-adjustment matrix for a specified category. The *grayMatrix* parameter specifies a matrix to be used for adjusting gray shades when the value of the *flags* parameter is [****ColorMatrixFlagsAltGray****](/windows/win32/Gdipluscolormatrix/ne-gdipluscolormatrix-colormatrixflags?branch=master).<br/> |
| GpStatus WINGDIPAPI GdipSetImageAttributesThreshold(GpImageAttributes \*imageattr, ColorAdjustType type, BOOL enableFlag, REAL threshold)<br/>                                                                                    | Status [**ImageAttributes::SetThreshold( IN REAL threshold, IN ColorAdjustType type = ColorAdjustTypeDefault )**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-setthreshold?branch=master)<br/> [**Status ImageAttributes::ClearThreshold(IN ColorAdjustType type = ColorAdjustTypeDefault)**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-clearthreshold?branch=master)<br/>                                                                                                | Sets the threshold (transparency range) for a specified category. <br/>The *enableFlag* parameter in the flat function is a Boolean value that specifies whether a separate threshold is enabled for the category specified by the *type* parameter. [**ImageAttributes::SetThreshold**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-setthreshold?branch=master) sets *enableFlag* to **TRUE**, and [**ImageAttributes::ClearThreshold**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-clearthreshold?branch=master) sets *enableFlag* to **FALSE**.Clears the threshold value for a specified category. <br/>                                                                                                                                                                                                                             |
| GpStatus WINGDIPAPI GdipSetImageAttributesGamma(GpImageAttributes \*imageattr, ColorAdjustType type, BOOL enableFlag, REAL gamma)<br/>                                                                                            | [**Status ImageAttributes::SetGamma(IN REAL gamma, IN ColorAdjustType type = ColorAdjustTypeDefault)**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-setgamma?branch=master)<br/> [**Status ImageAttributes::ClearGamma(IN ColorAdjustType type = ColorAdjustTypeDefault)**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-cleargamma?branch=master)<br/>                                                                                                                          | Sets the gamma value for a specified category. The *enableFlag* parameter in the flat function is a Boolean value that specifies whether a separate gamma is enabled for the category specified by the *type* parameter. [**ImageAttributes::SetGamma**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-setgamma?branch=master) sets *enableFlag* to **TRUE**, and [**ImageAttributes::ClearGamma**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-cleargamma?branch=master) sets *enableFlag* to **FALSE**.<br/> Disables gamma correction for a specified category. <br/>                                                                                                                                                                                                                                                                        |
| GpStatus WINGDIPAPI GdipSetImageAttributesNoOp(GpImageAttributes \*imageattr, ColorAdjustType type, BOOL enableFlag)<br/>                                                                                                         | [**Status ImageAttributes::SetNoOp( IN ColorAdjustType type = ColorAdjustTypeDefault )**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-setnoop?branch=master)<br/> [**Status ImageAttributes::ClearNoOp(IN ColorAdjustType type = ColorAdjustTypeDefault)**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-clearnoop?branch=master)<br/>                                                                                                                                                 | Turns off color adjustment for a specified category. You can call the [**ImageAttributes::ClearNoOp**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-clearnoop?branch=master) method to reinstate the color-adjustment settings that were in place before the call to [**ImageAttributes::SetNoOp**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-setnoop?branch=master) method . The *enableFlag* parameter in the flat function is a Boolean value that specifies whether a color adjustment is enabled for the category specified by the *type* parameter. **ImageAttributes::SetNoOp** sets *enableFlag* to **TRUE**, and **ImageAttributes::ClearNoOp** sets *enableFlag* to **FALSE**.<br/> Clears the NoOp setting for a specified category. <br/>                                                                                              |
| GpStatus WINGDIPAPI GdipSetImageAttributesColorKeys(GpImageAttributes \*imageattr, ColorAdjustType type, BOOL enableFlag, ARGB colorLow, ARGB colorHigh)<br/>                                                                     | [**Status ImageAttributes::SetColorKey( IN const Color& colorLow, IN const Color& colorHigh, IN ColorAdjustType type = ColorAdjustTypeDefault )**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-setcolorkey?branch=master)<br/> [**Status ImageAttributes::ClearColorKey(IN ColorAdjustType type = ColorAdjustTypeDefault)**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-clearcolorkey?branch=master)<br/>                                                         | Sets the color key (transparency range) for a specified category. The *enableFlag* parameter in the flat function is a Boolean value that specifies whether a separate transparency range is enabled for the category specified by the *type* parameter. [**ImageAttributes::SetColorKey**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-setcolorkey?branch=master) sets *enableFlag* to **TRUE**, and [**ImageAttributes::ClearColorKey**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-clearcolorkey?branch=master) sets *enableFlag* to **FALSE**.<br/> Clears the color key (transparency range) for a specified category. <br/>                                                                                                                                                                                               |
| GpStatus WINGDIPAPI GdipSetImageAttributesOutputChannel(GpImageAttributes \*imageattr, ColorAdjustType type, BOOL enableFlag, ColorChannelFlags channelFlags)<br/>                                                                | [**Status ImageAttributes::SetOutputChannel( IN ColorChannelFlags channelFlags, IN ColorAdjustType type = ColorAdjustTypeDefault )**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-setoutputchannel?branch=master)<br/> [**Status ImageAttributes::ClearOutputChannel(IN ColorAdjustType type = ColorAdjustTypeDefault)**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-clearoutputchannel?branch=master)<br/>                                                             | Sets the cyan-magenta-yellow-black (CMYK) output channel for a specified category. The *enableFlag* parameter in the flat function is a Boolean value that specifies whether a separate output channel is enabled for the category specified by the *type* parameter. [**ImageAttributes::SetOutputChannel**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-setoutputchannel?branch=master) sets *enableFlag* to **TRUE**, and [**ImageAttributes::ClearOutputChannel**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-clearoutputchannel?branch=master) sets *enableFlag* to **FALSE**.<br/> Clears the cyan-magenta-yellow-black (CMYK) output channel setting for a specified category. <br/>                                                                                                                                           |
| GpStatus WINGDIPAPI GdipSetImageAttributesOutputChannelColorProfile(GpImageAttributes \*imageattr, ColorAdjustType type, BOOL enableFlag, GDIPCONST WCHAR \*colorProfileFilename)<br/>                                            | [**Status ImageAttributes::SetOutputChannelColorProfile( IN const WCHAR \*colorProfileFilename, IN ColorAdjustType type = ColorAdjustTypeDefault )**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-setoutputchannelcolorprofile?branch=master)<br/> [**Status ImageAttributes::ClearOutputChannelColorProfile(IN ColorAdjustType type = ColorAdjustTypeDefault)**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-clearoutputchannelcolorprofile?branch=master)<br/> | Sets the output channel color-profile file for a specified category. The *enableFlag* parameter in the flat function is a Boolean value that specifies whether a separate output channel color profile is enabled for the category specified by the *type* parameter. [**ImageAttributes::SetOutputChannelColorProfile**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-setoutputchannelcolorprofile?branch=master) sets *enableFlag* to **TRUE**, and [**ImageAttributes::ClearOutputChannelColorProfile**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-clearoutputchannelcolorprofile?branch=master) sets *enableFlag* to **FALSE**.<br/> Clears the output channel color profile setting for a specified category. <br/>                                                                                                      |
| GpStatus WINGDIPAPI GdipSetImageAttributesRemapTable(GpImageAttributes \*imageattr, ColorAdjustType type, BOOL enableFlag, UINT mapSize, GDIPCONST ColorMap \*map)<br/>                                                           | [**Status ImageAttributes::SetRemapTable( IN UINT mapSize, IN const ColorMap \*map, IN ColorAdjustType type = ColorAdjustTypeDefault )**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-setremaptable?branch=master)<br/> [**Status ImageAttributes::ClearRemapTable(IN ColorAdjustType type = ColorAdjustTypeDefault)**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-clearremaptable?branch=master)<br/>                                                                   | Sets the color-remap table for a specified category. The *enableFlag* parameter in the flat function is a Boolean value that specifies whether a separate color remap table is enabled for the category specified by the *type* parameter. [**ImageAttributes::SetRemapTable**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-setremaptable?branch=master) sets *enableFlag* to **TRUE**, and [**ImageAttributes::ClearRemapTable**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-clearremaptable?branch=master) sets *enableFlag* to **FALSE**.<br/> Clears the color-remap table for a specified category. <br/>                                                                                                                                                                                                                         |
| GpStatus WINGDIPAPI GdipSetImageAttributesWrapMode(GpImageAttributes \*imageAttr, WrapMode wrap, ARGB argb, BOOL clamp )<br/>                                                                                                     | [**Status ImageAttributes::SetWrapMode(IN WrapMode wrap, IN const Color& color = Color(), IN BOOL clamp = **FALSE**)**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-setwrapmode?branch=master)<br/>                                                                                                                                                                                                                                                            | Sets the wrap mode of this [**ImageAttributes**](/windows/win32/gdiplusimageattributes/nl-gdiplusimageattributes-imageattributes?branch=master) object                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| GpStatus WINGDIPAPI GdipSetImageAttributesICMMode(GpImageAttributes \*imageAttr, BOOL on )<br/>                                                                                                                                   | Not called by wrapper methods.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                       | This function sets an internal state variable to the value specified by the *on* parameter. If this value is **TRUE**, Image Color Management (ICM) is used for all color adjustment. If the value is **FALSE**, ICM is not used.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| GpStatus WINGDIPAPI GdipGetImageAttributesAdjustedPalette(GpImageAttributes \*imageAttr, ColorPalette \* colorPalette, ColorAdjustType colorAdjustType )<br/>                                                                     | [**Status ImageAttributes::GetAdjustedPalette(IN OUT ColorPalette\* colorPalette, IN ColorAdjustType colorAdjustType) const**](/windows/win32/Gdiplusimageattributes/nf-gdiplusimageattributes-imageattributes-getadjustedpalette?branch=master)<br/>                                                                                                                                                                                                                                  | Adjusts the colors in a palette according to the adjustment settings of a specified category.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| GpStatus WINGDIPAPI GdipSetImageAttributesCachedBackground(GpImageAttributes \*imageattr, BOOL enableFlag)<br/>                                                                                                                   | Not called by wrapper methods.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                       | Sets or clears the CachedBackground member of a specified GpImageAttributes object. GDI+ does not use the CachedBackground member, so calling this function has no effect. The *imageattr* parameter specifies the GpImageAttributes object. The enableFlag parameter specifies whether the CachedBackground member is set (**TRUE**) or cleared (**FALSE**).                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |



 

 

 




