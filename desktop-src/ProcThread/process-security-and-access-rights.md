---
Description: The Microsoft Windows security model enables you to control access to process objects. For more information about security, see Access-Control Model.
ms.assetid: 508a17c4-88cd-431a-a102-00180a7f7ab5
title: Process Security and Access Rights
ms.technology: desktop
ms.prod: windows
ms.author: windowssdkdev
ms.topic: article
ms.date: 05/31/2018
---

# Process Security and Access Rights

The Microsoft Windows security model enables you to control access to process objects. For more information about security, see [Access-Control Model](https://msdn.microsoft.com/fd3b718a-5eff-4894-9fc6-d157ddb67330).

When a user logs in, the system collects a set of data that uniquely identifies the user during the authentication process, and stores it in an [access token](https://msdn.microsoft.com/350159c9-2399-427a-ba44-c897a9664299). This access token describes the security context of all processes associated with the user. The security context of a process is the set of credentials given to the process or the user account that created the process.

You can use a token to specify the current security context for a process using the [**CreateProcessWithTokenW**](/windows/desktop/api/WinBase/nf-winbase-createprocesswithtokenw) function. You can specify a [security descriptor](https://msdn.microsoft.com/4ab0e7b1-1b44-4368-b2bd-106c9d2c652c) for a process when you call the [**CreateProcess**](/windows/desktop/api/WinBase/nf-processthreadsapi-createprocessa), [**CreateProcessAsUser**](https://www.bing.com/search?q=**CreateProcessAsUser**), or [**CreateProcessWithLogonW**](/windows/desktop/api/WinBase/nf-winbase-createprocesswithlogonw) function. If you specify **NULL**, the process gets a default security descriptor. The ACLs in the default security descriptor for a process come from the primary or impersonation token of the creator.

To retrieve a process's security descriptor, call the [**GetSecurityInfo**](https://msdn.microsoft.com/64767a6b-cd79-4e02-881a-706a078ff446) function. To change a process's security descriptor, call the [**SetSecurityInfo**](https://msdn.microsoft.com/f1781ba9-81eb-46f9-b530-c390b67d65de) function.

The valid access rights for process objects include the [standard access rights](https://msdn.microsoft.com/f43bccce-0f8c-4732-b678-5fd3218a9f84) and some process-specific access rights. The following table lists the standard access rights used by all objects.

| Value                           | Meaning                                                                                                                                                                                                                                                                                  |
|---------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **DELETE** (0x00010000L)        | Required to delete the object.                                                                                                                                                                                                                                                           |
| **READ\_CONTROL** (0x00020000L) | Required to read information in the security descriptor for the object, not including the information in the SACL. To read or write the SACL, you must request the **ACCESS\_SYSTEM\_SECURITY** access right. For more information, see [SACL Access Right](https://msdn.microsoft.com/88198243-dae5-49ac-9d54-bfae7a3a0b1a). |
| **SYNCHRONIZE** (0x00100000L)   | The right to use the object for synchronization. This enables a thread to wait until the object is in the signaled state.                                                                                                                                                                |
| **WRITE\_DAC** (0x00040000L)    | Required to modify the DACL in the security descriptor for the object.                                                                                                                                                                                                                   |
| **WRITE\_OWNER** (0x00080000L)  | Required to change the owner in the security descriptor for the object.                                                                                                                                                                                                                  |



 

The following table lists the process-specific access rights.



| Value                                             | Meaning                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|---------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **PROCESS\_ALL\_ACCESS**                          | All possible access rights for a process object.**Windows Server 2003 and Windows XP:** The size of the **PROCESS\_ALL\_ACCESS** flag increased on Windows Server 2008 and Windows Vista. If an application compiled for Windows Server 2008 and Windows Vista is run on Windows Server 2003 or Windows XP, the **PROCESS\_ALL\_ACCESS** flag is too large and the function specifying this flag fails with **ERROR\_ACCESS\_DENIED**. To avoid this problem, specify the minimum set of access rights required for the operation. If **PROCESS\_ALL\_ACCESS** must be used, set \_WIN32\_WINNT to the minimum operating system targeted by your application (for example, `#define _WIN32_WINNT _WIN32_WINNT_WINXP`). For more information, see [Using the Windows Headers](https://msdn.microsoft.com/a4def563-8ddc-4630-ae8a-86c07cf98374). <br/> |
| **PROCESS\_CREATE\_PROCESS** (0x0080)             | Required to create a process.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **PROCESS\_CREATE\_THREAD** (0x0002)              | Required to create a thread.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **PROCESS\_DUP\_HANDLE** (0x0040)                 | Required to duplicate a handle using [**DuplicateHandle**](https://msdn.microsoft.com/9c8da574-5bda-49f1-a6b6-c026639d6504).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **PROCESS\_QUERY\_INFORMATION** (0x0400)          | Required to retrieve certain information about a process, such as its token, exit code, and priority class (see [**OpenProcessToken**](https://msdn.microsoft.com/1e760ad8-7e46-4748-8c45-36ad8efe936a)).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **PROCESS\_QUERY\_LIMITED\_INFORMATION** (0x1000) | Required to retrieve certain information about a process (see [**GetExitCodeProcess**](/windows/desktop/api/WinBase/nf-processthreadsapi-getexitcodeprocess), [**GetPriorityClass**](/windows/desktop/api/WinBase/nf-processthreadsapi-getpriorityclass), [**IsProcessInJob**](/windows/desktop/api/WinBase/), [**QueryFullProcessImageName**](/windows/desktop/api/WinBase/nf-winbase-queryfullprocessimagenamea)). A handle that has the **PROCESS\_QUERY\_INFORMATION** access right is automatically granted **PROCESS\_QUERY\_LIMITED\_INFORMATION**.**Windows Server 2003 and Windows XP:** This access right is not supported.<br/>                                                                                                                                                                                                                                                                                                                         |
| **PROCESS\_SET\_INFORMATION** (0x0200)            | Required to set certain information about a process, such as its priority class (see [**SetPriorityClass**](/windows/desktop/api/WinBase/nf-processthreadsapi-setpriorityclass)).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **PROCESS\_SET\_QUOTA** (0x0100)                  | Required to set memory limits using [**SetProcessWorkingSetSize**](/windows/desktop/api/WinBase/nf-winbase-setprocessworkingsetsize).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **PROCESS\_SUSPEND\_RESUME** (0x0800)             | Required to suspend or resume a process.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **PROCESS\_TERMINATE** (0x0001)                   | Required to terminate a process using [**TerminateProcess**](/windows/desktop/api/WinBase/nf-processthreadsapi-terminateprocess).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **PROCESS\_VM\_OPERATION** (0x0008)               | Required to perform an operation on the address space of a process (see [**VirtualProtectEx**](https://msdn.microsoft.com/6afd7ae6-e4c5-483c-a638-c85781674c7b) and [**WriteProcessMemory**](https://msdn.microsoft.com/9cd91f1c-58ce-4adc-b027-45748543eb06)).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **PROCESS\_VM\_READ** (0x0010)                    | Required to read memory in a process using [**ReadProcessMemory**](https://msdn.microsoft.com/8774e145-ee7f-44de-85db-0445b905f986).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| **PROCESS\_VM\_WRITE** (0x0020)                   | Required to write to memory in a process using [**WriteProcessMemory**](https://msdn.microsoft.com/9cd91f1c-58ce-4adc-b027-45748543eb06).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **SYNCHRONIZE** (0x00100000L)                     | Required to wait for the process to terminate using the [wait functions](https://msdn.microsoft.com/9c66c71d-fdfd-42ae-895c-2fc842b5bc7a).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |



 

To open a handle to another process and obtain full access rights, you must enable the **SeDebugPrivilege** privilege. For more information, see [Changing Privileges in a Token](https://msdn.microsoft.com/b8e47d04-07c1-4d57-8209-6b0c397476e5).

The handle returned by the [**CreateProcess**](/windows/desktop/api/WinBase/nf-processthreadsapi-createprocessa) function has **PROCESS\_ALL\_ACCESS** access to the process object. When you call the [**OpenProcess**](/windows/desktop/api/WinBase/nf-processthreadsapi-openprocess) function, the system checks the requested [access rights](https://msdn.microsoft.com/da67c486-d2e7-4632-ac7a-c18aabc3f21d) against the DACL in the process's security descriptor. When you call the [**GetCurrentProcess**](/windows/desktop/api/WinBase/nf-processthreadsapi-getcurrentprocess) function, the system returns a pseudohandle with the maximum access that the DACL allows to the caller.

You can request the **ACCESS\_SYSTEM\_SECURITY** access right to a process object if you want to read or write the object's SACL. For more information, see [Access-Control Lists (ACLs)](https://www.bing.com/search?q=Access-Control+Lists+(ACLs)) and [SACL Access Right](https://msdn.microsoft.com/88198243-dae5-49ac-9d54-bfae7a3a0b1a).

> \[!Warning\]  
> A process that has some of the access rights noted here can use them to gain other access rights. For example, if process A has a handle to process B with **PROCESS\_DUP\_HANDLE** access, it can duplicate the pseudo handle for process B. This creates a handle that has maximum access to process B. For more information on pseudo handles, see [**GetCurrentProcess**](/windows/desktop/api/WinBase/nf-processthreadsapi-getcurrentprocess).

 

## Protected Processes

Windows Vista introduces *protected processes* to enhance support for Digital Rights Management. The system restricts access to protected processes and the threads of protected processes.

The following standard access rights are not allowed from a process to a protected process:

<dl> **DELETE**  
**READ\_CONTROL**  
**WRITE\_DAC**  
**WRITE\_OWNER**  
</dl>

The following specific access rights are not allowed from a process to a protected process:

<dl> **PROCESS\_ALL\_ACCESS**  
**PROCESS\_CREATE\_PROCESS**  
**PROCESS\_CREATE\_THREAD**  
**PROCESS\_DUP\_HANDLE**  
**PROCESS\_QUERY\_INFORMATION**  
**PROCESS\_SET\_INFORMATION**  
**PROCESS\_SET\_QUOTA**  
**PROCESS\_VM\_OPERATION**  
**PROCESS\_VM\_READ**  
**PROCESS\_VM\_WRITE**  
</dl>

The **PROCESS\_QUERY\_LIMITED\_INFORMATION** right was introduced to provide access to a subset of the information available through **PROCESS\_QUERY\_INFORMATION**.

 

 




