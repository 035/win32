---
Description: Microsoft Windows enables you to control access to thread objects. For more information about security, see Access-Control Model.
ms.assetid: 72709446-5c59-4fac-8dc8-7912906ecc85
title: Thread Security and Access Rights
ms.technology: desktop
ms.prod: windows
ms.author: windowssdkdev
ms.topic: article
ms.date: 05/31/2018
---

# Thread Security and Access Rights

Microsoft Windows enables you to control access to thread objects. For more information about security, see [Access-Control Model](https://msdn.microsoft.com/windows/desktop/fd3b718a-5eff-4894-9fc6-d157ddb67330).

You can specify a [security descriptor](https://msdn.microsoft.com/windows/desktop/4ab0e7b1-1b44-4368-b2bd-106c9d2c652c) for a thread when you call the [**CreateProcess**](/windows/desktop/api/WinBase/nf-processthreadsapi-createprocessa), [**CreateProcessAsUser**](https://www.bing.com/search?q=**CreateProcessAsUser**), [**CreateProcessWithLogonW**](/windows/desktop/api/WinBase/nf-winbase-createprocesswithlogonw), [**CreateThread**](/windows/desktop/api/WinBase/nf-processthreadsapi-createthread), or [**CreateRemoteThread**](/windows/desktop/api/WinBase/nf-processthreadsapi-createremotethread) function. If you specify **NULL**, the thread gets a default security descriptor. The ACLs in the default security descriptor for a thread come from the primary or impersonation token of the creator.

To retrieve a thread's security descriptor, call the [**GetSecurityInfo**](https://msdn.microsoft.com/windows/desktop/64767a6b-cd79-4e02-881a-706a078ff446) function. To change a thread's security descriptor, call the [**SetSecurityInfo**](https://msdn.microsoft.com/windows/desktop/f1781ba9-81eb-46f9-b530-c390b67d65de) function.

The handle returned by the [**CreateThread**](/windows/desktop/api/WinBase/nf-processthreadsapi-createthread) function has **THREAD\_ALL\_ACCESS** access to the thread object. When you call the [**GetCurrentThread**](/windows/desktop/api/WinBase/nf-processthreadsapi-getcurrentthread) function, the system returns a pseudohandle with the maximum access that the thread's security descriptor allows the caller.

The valid access rights for thread objects include the [standard access rights](https://msdn.microsoft.com/windows/desktop/f43bccce-0f8c-4732-b678-5fd3218a9f84) and some thread-specific access rights. The following table lists the standard access rights used by all objects.

| Value                           | Meaning                                                                                                                                                                                                                                                                                  |
|---------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **DELETE** (0x00010000L)        | Required to delete the object.                                                                                                                                                                                                                                                           |
| **READ\_CONTROL** (0x00020000L) | Required to read information in the security descriptor for the object, not including the information in the SACL. To read or write the SACL, you must request the **ACCESS\_SYSTEM\_SECURITY** access right. For more information, see [SACL Access Right](https://msdn.microsoft.com/windows/desktop/88198243-dae5-49ac-9d54-bfae7a3a0b1a). |
| **SYNCHRONIZE** (0x00100000L)   | The right to use the object for synchronization. This enables a thread to wait until the object is in the signaled state.                                                                                                                                                                |
| **WRITE\_DAC** (0x00040000L)    | Required to modify the DACL in the security descriptor for the object.                                                                                                                                                                                                                   |
| **WRITE\_OWNER** (0x00080000L)  | Required to change the owner in the security descriptor for the object.                                                                                                                                                                                                                  |



 

The following table lists the thread-specific access rights.



| Value                                            | Meaning                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|--------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **SYNCHRONIZE** (0x00100000L)                    | Enables the use of the thread handle in any of the [wait functions](https://msdn.microsoft.com/windows/desktop/9c66c71d-fdfd-42ae-895c-2fc842b5bc7a).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **THREAD\_ALL\_ACCESS**                          | All possible access rights for a thread object.**Windows Server 2003 and Windows XP:** The value of the **THREAD\_ALL\_ACCESS** flag increased on Windows Server 2008 and Windows Vista. If an application compiled for Windows Server 2008 and Windows Vista is run on Windows Server 2003 or Windows XP, the **THREAD\_ALL\_ACCESS** flag contains access bits that are not supported and the function specifying this flag fails with **ERROR\_ACCESS\_DENIED**. To avoid this problem, specify the minimum set of access rights required for the operation. If **THREAD\_ALL\_ACCESS** must be used, set **\_WIN32\_WINNT** to the minimum operating system targeted by your application (for example, `#define _WIN32_WINNT _WIN32_WINNT_WINXP`). For more information, see [Using the Windows Headers](https://msdn.microsoft.com/windows/desktop/a4def563-8ddc-4630-ae8a-86c07cf98374). <br/> |
| **THREAD\_DIRECT\_IMPERSONATION** (0x0200)       | Required for a server thread that impersonates a client.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **THREAD\_GET\_CONTEXT** (0x0008)                | Required to read the context of a thread using [**GetThreadContext**](https://msdn.microsoft.com/windows/desktop/3b65283e-34d2-4374-87fe-fa8ae45fbbcf).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **THREAD\_IMPERSONATE** (0x0100)                 | Required to use a thread's security information directly without calling it by using a communication mechanism that provides impersonation services.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **THREAD\_QUERY\_INFORMATION** (0x0040)          | Required to read certain information from the thread object, such as the exit code (see [**GetExitCodeThread**](/windows/desktop/api/WinBase/nf-processthreadsapi-getexitcodethread)).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **THREAD\_QUERY\_LIMITED\_INFORMATION** (0x0800) | Required to read certain information from the thread objects (see [**GetProcessIdOfThread**](/windows/desktop/api/WinBase/nf-processthreadsapi-getprocessidofthread)). A handle that has the **THREAD\_QUERY\_INFORMATION** access right is automatically granted **THREAD\_QUERY\_LIMITED\_INFORMATION**.**Windows Server 2003 and Windows XP:** This access right is not supported.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **THREAD\_SET\_CONTEXT** (0x0010)                | Required to write the context of a thread using [**SetThreadContext**](https://msdn.microsoft.com/windows/desktop/be134953-b569-48ea-80ac-ab14dee24500).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **THREAD\_SET\_INFORMATION** (0x0020)            | Required to set certain information in the thread object.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **THREAD\_SET\_LIMITED\_INFORMATION** (0x0400)   | Required to set certain information in the thread object. A handle that has the **THREAD\_SET\_INFORMATION** access right is automatically granted **THREAD\_SET\_LIMITED\_INFORMATION**.**Windows Server 2003 and Windows XP:** This access right is not supported.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **THREAD\_SET\_THREAD\_TOKEN** (0x0080)          | Required to set the impersonation token for a thread using [**SetThreadToken**](https://msdn.microsoft.com/windows/desktop/ba1a4fce-b3cc-423d-b213-5dfca3dea708).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **THREAD\_SUSPEND\_RESUME** (0x0002)             | Required to suspend or resume a thread (see [**SuspendThread**](/windows/desktop/api/WinBase/nf-processthreadsapi-suspendthread) and [**ResumeThread**](/windows/desktop/api/WinBase/nf-processthreadsapi-resumethread)).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **THREAD\_TERMINATE** (0x0001)                   | Required to terminate a thread using [**TerminateThread**](/windows/desktop/api/WinBase/nf-processthreadsapi-terminatethread).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |



 

You can request the **ACCESS\_SYSTEM\_SECURITY** access right to a thread object if you want to read or write the object's SACL. For more information, see [Access-Control Lists (ACLs)](https://www.bing.com/search?q=Access-Control Lists (ACLs)) and [SACL Access Right](https://msdn.microsoft.com/windows/desktop/88198243-dae5-49ac-9d54-bfae7a3a0b1a).

## Protected Processes

*Protected processes* enhance support for Digital Rights Management. The system restricts access to protected processes and the threads of protected processes.

**Windows Server 2003 and Windows XP:** Protected processes were added starting with Windows Vista.

The following specific access rights are not allowed from a process to the threads of a protected process:

<dl> **THREAD\_ALL\_ACCESS**  
**THREAD\_DIRECT\_IMPERSONATION**  
**THREAD\_GET\_CONTEXT**  
**THREAD\_IMPERSONATE**  
**THREAD\_QUERY\_INFORMATION**  
**THREAD\_SET\_CONTEXT**  
**THREAD\_SET\_INFORMATION**  
**THREAD\_SET\_TOKEN**  
**THREAD\_TERMINATE**  
</dl>

The **THREAD\_QUERY\_LIMITED\_INFORMATION** right was introduced to provide access to a subset of the information available through **THREAD\_QUERY\_INFORMATION**.

 

 




