---
Description: Microsoft Windows enables you to control access to thread objects. For more information about security, see Access-Control Model.
ms.assetid: 72709446-5c59-4fac-8dc8-7912906ecc85
title: Thread Security and Access Rights
ms.date: 05/31/2018
ms.topic: article
ms.author: windowssdkdev
ms.prod: windows
ms.technology: desktop
---

# Thread Security and Access Rights

Microsoft Windows enables you to control access to thread objects. For more information about security, see [Access-Control Model](security.access_control_model).

You can specify a [security descriptor](security.security_descriptors) for a thread when you call the [**CreateProcess**](/windows/win32/WinBase/nf-processthreadsapi-createprocessa?branch=master), [**CreateProcessAsUser**](createprocessasuser.md), [**CreateProcessWithLogonW**](/windows/win32/WinBase/nf-winbase-createprocesswithlogonw?branch=master), [**CreateThread**](/windows/win32/WinBase/nf-processthreadsapi-createthread?branch=master), or [**CreateRemoteThread**](/windows/win32/WinBase/nf-processthreadsapi-createremotethread?branch=master) function. If you specify **NULL**, the thread gets a default security descriptor. The ACLs in the default security descriptor for a thread come from the primary or impersonation token of the creator.

To retrieve a thread's security descriptor, call the [**GetSecurityInfo**](security.getsecurityinfo) function. To change a thread's security descriptor, call the [**SetSecurityInfo**](security.setsecurityinfo) function.

The handle returned by the [**CreateThread**](/windows/win32/WinBase/nf-processthreadsapi-createthread?branch=master) function has **THREAD\_ALL\_ACCESS** access to the thread object. When you call the [**GetCurrentThread**](/windows/win32/WinBase/nf-processthreadsapi-getcurrentthread?branch=master) function, the system returns a pseudohandle with the maximum access that the thread's security descriptor allows the caller.

The valid access rights for thread objects include the [standard access rights](security.standard_access_rights) and some thread-specific access rights. The following table lists the standard access rights used by all objects.

| Value                           | Meaning                                                                                                                                                                                                                                                                                  |
|---------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **DELETE** (0x00010000L)        | Required to delete the object.                                                                                                                                                                                                                                                           |
| **READ\_CONTROL** (0x00020000L) | Required to read information in the security descriptor for the object, not including the information in the SACL. To read or write the SACL, you must request the **ACCESS\_SYSTEM\_SECURITY** access right. For more information, see [SACL Access Right](security.sacl_access_right). |
| **SYNCHRONIZE** (0x00100000L)   | The right to use the object for synchronization. This enables a thread to wait until the object is in the signaled state.                                                                                                                                                                |
| **WRITE\_DAC** (0x00040000L)    | Required to modify the DACL in the security descriptor for the object.                                                                                                                                                                                                                   |
| **WRITE\_OWNER** (0x00080000L)  | Required to change the owner in the security descriptor for the object.                                                                                                                                                                                                                  |



 

The following table lists the thread-specific access rights.



| Value                                            | Meaning                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|--------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **SYNCHRONIZE** (0x00100000L)                    | Enables the use of the thread handle in any of the [wait functions](base.wait_functions).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **THREAD\_ALL\_ACCESS**                          | All possible access rights for a thread object.**Windows Server 2003 and Windows XP:** The value of the **THREAD\_ALL\_ACCESS** flag increased on Windows Server 2008 and Windows Vista. If an application compiled for Windows Server 2008 and Windows Vista is run on Windows Server 2003 or Windows XP, the **THREAD\_ALL\_ACCESS** flag contains access bits that are not supported and the function specifying this flag fails with **ERROR\_ACCESS\_DENIED**. To avoid this problem, specify the minimum set of access rights required for the operation. If **THREAD\_ALL\_ACCESS** must be used, set **\_WIN32\_WINNT** to the minimum operating system targeted by your application (for example, `#define _WIN32_WINNT _WIN32_WINNT_WINXP`). For more information, see [Using the Windows Headers](winprog.using_the_windows_headers). <br/> |
| **THREAD\_DIRECT\_IMPERSONATION** (0x0200)       | Required for a server thread that impersonates a client.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **THREAD\_GET\_CONTEXT** (0x0008)                | Required to read the context of a thread using [**GetThreadContext**](base.getthreadcontext).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **THREAD\_IMPERSONATE** (0x0100)                 | Required to use a thread's security information directly without calling it by using a communication mechanism that provides impersonation services.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **THREAD\_QUERY\_INFORMATION** (0x0040)          | Required to read certain information from the thread object, such as the exit code (see [**GetExitCodeThread**](/windows/win32/WinBase/nf-processthreadsapi-getexitcodethread?branch=master)).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **THREAD\_QUERY\_LIMITED\_INFORMATION** (0x0800) | Required to read certain information from the thread objects (see [**GetProcessIdOfThread**](/windows/win32/WinBase/nf-processthreadsapi-getprocessidofthread?branch=master)). A handle that has the **THREAD\_QUERY\_INFORMATION** access right is automatically granted **THREAD\_QUERY\_LIMITED\_INFORMATION**.**Windows Server 2003 and Windows XP:** This access right is not supported.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **THREAD\_SET\_CONTEXT** (0x0010)                | Required to write the context of a thread using [**SetThreadContext**](base.setthreadcontext).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **THREAD\_SET\_INFORMATION** (0x0020)            | Required to set certain information in the thread object.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **THREAD\_SET\_LIMITED\_INFORMATION** (0x0400)   | Required to set certain information in the thread object. A handle that has the **THREAD\_SET\_INFORMATION** access right is automatically granted **THREAD\_SET\_LIMITED\_INFORMATION**.**Windows Server 2003 and Windows XP:** This access right is not supported.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **THREAD\_SET\_THREAD\_TOKEN** (0x0080)          | Required to set the impersonation token for a thread using [**SetThreadToken**](security.setthreadtoken).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **THREAD\_SUSPEND\_RESUME** (0x0002)             | Required to suspend or resume a thread (see [**SuspendThread**](/windows/win32/WinBase/nf-processthreadsapi-suspendthread?branch=master) and [**ResumeThread**](/windows/win32/WinBase/nf-processthreadsapi-resumethread?branch=master)).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **THREAD\_TERMINATE** (0x0001)                   | Required to terminate a thread using [**TerminateThread**](/windows/win32/WinBase/nf-processthreadsapi-terminatethread?branch=master).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |



 

You can request the **ACCESS\_SYSTEM\_SECURITY** access right to a thread object if you want to read or write the object's SACL. For more information, see [Access-Control Lists (ACLs)](security.access_control_lists_acls_) and [SACL Access Right](security.sacl_access_right).

## Protected Processes

*Protected processes* enhance support for Digital Rights Management. The system restricts access to protected processes and the threads of protected processes.

**Windows Server 2003 and Windows XP:** Protected processes were added starting with Windows Vista.

The following specific access rights are not allowed from a process to the threads of a protected process:

<dl> **THREAD\_ALL\_ACCESS**  
**THREAD\_DIRECT\_IMPERSONATION**  
**THREAD\_GET\_CONTEXT**  
**THREAD\_IMPERSONATE**  
**THREAD\_QUERY\_INFORMATION**  
**THREAD\_SET\_CONTEXT**  
**THREAD\_SET\_INFORMATION**  
**THREAD\_SET\_TOKEN**  
**THREAD\_TERMINATE**  
</dl>

The **THREAD\_QUERY\_LIMITED\_INFORMATION** right was introduced to provide access to a subset of the information available through **THREAD\_QUERY\_INFORMATION**.

 

 




