---
Description: Microsoft Windows-format metafiles are limited in their capabilities and should rarely be used.
ms.assetid: ebbf871b-cf78-4a90-8f27-e44699c17178
title: Windows-Format Metafiles
ms.date: 05/31/2018
ms.topic: article
ms.author: windowssdkdev
ms.prod: windows
ms.technology: desktop
---

# Windows-Format Metafiles

Microsoft Windows-format metafiles are limited in their capabilities and should rarely be used. The Windows-format functions are supported to maintain backward compatibility with applications that were written to run as 16 bit Windows-based applications. Instead, you should use the enhanced-format functions.

A *Windows-format metafile* is used by 16-bit Windows-based applications. The format consists of a header and an array of metafile records.

The following are the limitations of this format:

-   A Windows-format metafile is application and device dependent. Changes in the application's mapping modes or the device resolution affect the appearance of metafiles created in this format.
-   A Windows-format metafile does not contain a comprehensive header that describes the original picture dimensions, the resolution of the device on which the picture was created, an optional text description, or an optional palette.
-   A Windows-format metafile does not support the new curve, path, and transformation functions. See the list of supported functions in the table that follows.
-   Some Windows-format metafile records cannot be scaled.
-   The metafile device context associated with a Windows-format metafile cannot be queried (that is, an application cannot retrieve device-resolution data, font metrics, and so on).

The following are the only functions that are supported by Windows-format metafiles.



|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**AnimatePalette**](/windows/win32/Wingdi/nf-wingdi-animatepalette?branch=master)[**Arc**](/windows/win32/Wingdi/nf-wingdi-arc?branch=master)<br/> [**BitBlt**](/windows/win32/Wingdi/nf-wingdi-bitblt?branch=master)<br/> [**Chord**](/windows/win32/Wingdi/nf-wingdi-chord?branch=master)<br/> [**CreateBrushIndirect**](/windows/win32/Wingdi/nf-wingdi-createbrushindirect?branch=master)<br/> [**CreateDIBPatternBrush**](/windows/win32/Wingdi/nf-wingdi-createdibpatternbrush?branch=master)<br/> [**CreateFontIndirect**](/windows/win32/Wingdi/nf-wingdi-createfontindirecta?branch=master)<br/> [**CreatePalette**](/windows/win32/Wingdi/nf-wingdi-createpalette?branch=master)<br/> [**CreatePatternBrush**](/windows/win32/Wingdi/nf-wingdi-createpatternbrush?branch=master)<br/> [**CreatePenIndirect**](/windows/win32/Wingdi/nf-wingdi-createpenindirect?branch=master)<br/> [**DeleteObject**](/windows/win32/Wingdi/nf-wingdi-deleteobject?branch=master)<br/> [**Ellipse**](/windows/win32/Wingdi/nf-wingdi-ellipse?branch=master)<br/> [**Escape**](gdi.escape)<br/> [**ExcludeClipRect**](/windows/win32/Wingdi/nf-wingdi-excludecliprect?branch=master)<br/> [**ExtFloodFill**](/windows/win32/Wingdi/nf-wingdi-extfloodfill?branch=master)<br/> [**ExtTextOut**](/windows/win32/Wingdi/nf-wingdi-exttextouta?branch=master)<br/> [**FillRgn**](/windows/win32/Wingdi/nf-wingdi-fillrgn?branch=master)<br/> [**FloodFill**](/windows/win32/Wingdi/nf-wingdi-floodfill?branch=master)<br/> [**FrameRgn**](/windows/win32/Wingdi/nf-wingdi-framergn?branch=master)<br/> [**IntersectClipRect**](/windows/win32/Wingdi/nf-wingdi-intersectcliprect?branch=master)<br/> [**InvertRgn**](/windows/win32/Wingdi/nf-wingdi-invertrgn?branch=master)<br/> | [**LineTo**](/windows/win32/Wingdi/nf-wingdi-lineto?branch=master)[**MoveToEx**](/windows/win32/Wingdi/nf-wingdi-movetoex?branch=master)<br/> [**OffsetClipRgn**](/windows/win32/Wingdi/nf-wingdi-offsetcliprgn?branch=master)<br/> [**OffsetViewportOrgEx**](/windows/win32/Wingdi/nf-wingdi-offsetviewportorgex?branch=master)<br/> [**OffsetWindowOrgEx**](/windows/win32/Wingdi/nf-wingdi-offsetwindoworgex?branch=master)<br/> [**PaintRgn**](/windows/win32/Wingdi/nf-wingdi-paintrgn?branch=master)<br/> [**PatBlt**](/windows/win32/Wingdi/nf-wingdi-patblt?branch=master)<br/> [**Pie**](/windows/win32/Wingdi/nf-wingdi-pie?branch=master)<br/> [**Polygon**](/windows/win32/Wingdi/nf-wingdi-polygon?branch=master)<br/> [**Polyline**](/windows/win32/Wingdi/nf-wingdi-polyline?branch=master)<br/> [**PolyPolygon**](/windows/win32/Wingdi/nf-wingdi-polypolygon?branch=master)<br/> [**RealizePalette**](/windows/win32/Wingdi/nf-wingdi-realizepalette?branch=master)<br/> [**Rectangle**](/windows/win32/Wingdi/nf-wingdi-rectangle?branch=master)<br/> [**ResizePalette**](/windows/win32/Wingdi/nf-wingdi-resizepalette?branch=master)<br/> [**RestoreDC**](/windows/win32/Wingdi/nf-wingdi-restoredc?branch=master)<br/> [**RoundRect**](/windows/win32/Wingdi/nf-wingdi-roundrect?branch=master)<br/> [**SaveDC**](/windows/win32/Wingdi/nf-wingdi-savedc?branch=master)<br/> [**ScaleViewportExtEx**](/windows/win32/Wingdi/nf-wingdi-scaleviewportextex?branch=master)<br/> [**ScaleWindowExtEx**](/windows/win32/Wingdi/nf-wingdi-scalewindowextex?branch=master)<br/> [**SelectClipRgn**](/windows/win32/Wingdi/nf-wingdi-selectcliprgn?branch=master)<br/> [**SelectObject**](/windows/win32/Wingdi/nf-wingdi-selectobject?branch=master)<br/> | [**SelectPalette**](/windows/win32/Wingdi/nf-wingdi-selectpalette?branch=master)[**SetBkColor**](/windows/win32/Wingdi/nf-wingdi-setbkcolor?branch=master)<br/> [**SetBkMode**](/windows/win32/Wingdi/nf-wingdi-setbkmode?branch=master)<br/> [**SetDIBitsToDevice**](/windows/win32/Wingdi/nf-wingdi-setdibitstodevice?branch=master)<br/> [**SetMapMode**](/windows/win32/Wingdi/nf-wingdi-setmapmode?branch=master)<br/> [**SetMapperFlags**](/windows/win32/Wingdi/nf-wingdi-setmapperflags?branch=master)<br/> [**SetPaletteEntries**](/windows/win32/Wingdi/nf-wingdi-setpaletteentries?branch=master)<br/> [**SetPixel**](/windows/win32/Wingdi/nf-wingdi-setpixel?branch=master)<br/> [**SetPolyFillMode**](/windows/win32/Wingdi/nf-wingdi-setpolyfillmode?branch=master)<br/> [**SetROP2**](/windows/win32/Wingdi/nf-wingdi-setrop2?branch=master)<br/> [**SetStretchBltMode**](/windows/win32/Wingdi/nf-wingdi-setstretchbltmode?branch=master)<br/> [**SetTextAlign**](/windows/win32/Wingdi/nf-wingdi-settextalign?branch=master)<br/> [**SetTextCharacterExtra**](/windows/win32/Wingdi/nf-wingdi-settextcharacterextra?branch=master)<br/> [**SetTextColor**](/windows/win32/Wingdi/nf-wingdi-settextcolor?branch=master)<br/> [**SetTextJustification**](/windows/win32/Wingdi/nf-wingdi-settextjustification?branch=master)<br/> [**SetViewportOrgEx**](/windows/win32/Wingdi/nf-wingdi-setviewportorgex?branch=master)<br/> [**SetWindowExtEx**](/windows/win32/Wingdi/nf-wingdi-setwindowextex?branch=master)<br/> [**SetWindowOrgEx**](/windows/win32/Wingdi/nf-wingdi-setwindoworgex?branch=master)<br/> [**StretchBlt**](/windows/win32/Wingdi/nf-wingdi-stretchblt?branch=master)<br/> [**StretchDIBits**](/windows/win32/Wingdi/nf-wingdi-stretchdibits?branch=master)<br/> [**TextOut**](/windows/win32/Wingdi/nf-wingdi-textouta?branch=master)<br/> |



 

To convert a Windows-format metafile to an enhanced-format metafile, call the [**GetMetaFileBitsEx**](/windows/win32/Wingdi/nf-wingdi-getmetafilebitsex?branch=master) function to retrieve the data from the Windows-format metafile and then call the [**SetWinMetaFileBits**](/windows/win32/Wingdi/nf-wingdi-setwinmetafilebits?branch=master) function to convert this data into an enhanced-format metafile. To convert an enhanced-format record into a Windows-format record, call the [**GetWinMetaFileBits**](/windows/win32/Wingdi/nf-wingdi-getwinmetafilebits?branch=master) function.

 

 




