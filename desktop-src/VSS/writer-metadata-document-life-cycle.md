---
Description: In response to an Identify event, each writer present on the system constructs its own Writer Metadata Document using IVssCreateWriterMetadata. An Identify event is typically generated by a requester calling IVssBackupComponentsGatherWriterMetadata.
ms.assetid: bae9bbe7-ca55-47cb-b253-8092007cb181
title: Writer Metadata Document Life Cycle
ms.date: 05/31/2018
ms.topic: article
ms.author: windowssdkdev
ms.prod: windows
ms.technology: desktop
---

# Writer Metadata Document Life Cycle

In response to an [*Identify event*](vssgloss-i.md#base-vssgloss-identify-event), each writer present on the system constructs its own Writer Metadata Document using [**IVssCreateWriterMetadata**](/windows/win32/VsWriter/nl-vswriter-ivsscreatewritermetadata?branch=master). An *Identify event* is typically generated by a requester calling [**IVssBackupComponents::GatherWriterMetadata**](/windows/win32/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata?branch=master).

When creating a Writer Metadata Document, either through the [**IVssCreateWriterMetadata**](/windows/win32/VsWriter/nl-vswriter-ivsscreatewritermetadata?branch=master) interface or through writer initialization ([**CVssWriter::Initialize**](/windows/win32/VsWriter/nf-vswriter-cvsswriter-initialize?branch=master)), a writer must explicitly specify the following:

-   [*Restore method*](vssgloss-r.md#base-vssgloss-restore-method)
-   Writer name
-   [*Writer class ID*](vssgloss-w.md#base-vssgloss-writer-class)
-   Data usage (see [**VSS\_USAGE\_TYPE**](/windows/win32/VsWriter/ne-vswriter-vss_usage_type?branch=master))
-   Date source type (see [**VSS\_SOURCE\_TYPE**](/windows/win32/VsWriter/ne-vswriter-vss_source_type?branch=master))

In addition, it may also specify the following:

-   Components (which may or may not contain file sets)
-   Add alternate mappings
-   Exclude file lists

An overview of Writer Metadata Document creation is found in [Writer Actions during Backup Initialization](overview-of-backup-initialization.md#writer-actions-during-backup-initialization).

Requesters typically make use of one of two methods to obtain access to writer metadata:

-   During most backup operations, a requester uses [**IVssBackupComponents::GetWriterMetadata**](/windows/win32/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadata?branch=master) to obtain an instance of the [**IVssExamineWriterMetadata**](/windows/win32/VsBackup/nl-vsbackup-ivssexaminewritermetadata?branch=master) interface to allow access to the metadata of a currently executing writer.
-   For restore operations, or backups using imported shadow copies (see [Importing Transportable Shadow Copied Volumes](importing-transportable-shadow-copied-volumes.md) for more information on importing shadow copies), a requester retrieves an XML document containing the metadata and uses [**CreateVssExamineWriterMetadata**](/windows/win32/VsBackup/nf-vsbackup-createvssexaminewritermetadata?branch=master) to obtain an [**IVssExamineWriterMetadata**](/windows/win32/VsBackup/nl-vsbackup-ivssexaminewritermetadata?branch=master) interface, which it uses to read the restore metadata.

Writer Metadata Documents enable the requester performing a backup to learn about currently executing writers during the discovery phase of a backup.

For those writers chosen to participate in a backup, a requester imports much, but not all, of the information in the Writer Metadata Document into its own Backup Components Document during the discovery phase of a backup.

However, only Writer Metadata Documents and not the Backup Components Document contain the file and path specifications.

For more information on how the discovery phase of a backup operation is conducted, see [Overview of the Backup Discovery Phase](overview-of-the-backup-discovery-phase.md).

In addition, only [*explicitly included*](vssgloss-e.md#base-vssgloss-explicit-component-inclusion) components have their information stored in the Backup Components Document during a backup operation. Information on [*implicitly included*](vssgloss-i.md#base-vssgloss-implicit-component-inclusion) components is not included in the Backup Components Document during a backup operation, and must be interpolated using information about the explicitly included components and the available Writer Metadata Documents.

Implicitly included components may still be [*selectable for restore*](vssgloss-s.md#base-vssgloss-selectability-for-restore) and may need to be explicitly included in the Backup Components Document at restore time. In this case, just as adding a component during a backup operation required access to the component's writer's Writer Metadata Document (then retrieved from the writer), a requester will require access to a copy of that writer's Writer Metadata Documents stored at backup time.

Therefore, the only way to obtain all the information about all the files and components involved in a backup or restore is to have each Writer Metadata Document for each writer participating in a backup stored along with the Backup Components Document. (For more information, see [Overview of Actual File Restoration](overview-of-actual-file-restoration.md).)

 

 



