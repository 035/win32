---
title: Mandatory and Optional Interfaces
description: Mandatory and Optional Interfaces
ms.assetid: 582c9dd5-f8ab-48df-afb3-fba931ee0dea
keywords:
- Windows Media Device Manager,interfaces
- Device Manager,interfaces
- programming guide,interfaces
- service providers,interfaces
- creating service providers,interfaces
- interfaces
ms.date: 05/31/2018
ms.topic: article
ms.author: windowssdkdev
ms.prod: windows
ms.technology: desktop
---

# Mandatory and Optional Interfaces

The following table describes the mandatory and optional interfaces and methods for service providers to implement. All the interfaces with one or more mandatory methods must be implemented. A mandatory method cannot return WMDM\_E\_NOTSUPPORTED or E\_NOTIMPL.



| Interface and method                                                                                                                  | Implementation option                                                                                                                                                                                                                              |
|---------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**IMDServiceProvider::EnumDevices**](/windows/win32/mswmdm/nf-mswmdm-imdserviceprovider-enumdevices?branch=master)                                                             | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDServiceProvider::GetDeviceCount**](/windows/win32/mswmdm/nf-mswmdm-imdserviceprovider-getdevicecount?branch=master)                                                       | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDServiceProvider2::CreateDevice**](/windows/win32/mswmdm/nf-mswmdm-imdserviceprovider2-createdevice?branch=master)                                                         | Optional. This method must be implemented for PnP and Windows Explorer support.                                                                                                                                                                    |
| [**IMDSPDevice::EnumStorage**](/windows/win32/mswmdm/nf-mswmdm-imdspdevice-enumstorage?branch=master)                                                                           | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPDevice::GetDeviceIcon**](/windows/win32/mswmdm/nf-mswmdm-imdspdevice-getdeviceicon?branch=master)                                                                       | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPDevice::GetFormatSupport**](/windows/win32/mswmdm/nf-mswmdm-imdspdevice-getformatsupport?branch=master)                                                                 | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPDevice::GetManufacturer**](/windows/win32/mswmdm/nf-mswmdm-imdspdevice-getmanufacturer?branch=master)                                                                   | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPDevice::GetName**](/windows/win32/mswmdm/nf-mswmdm-imdspdevice-getname?branch=master)                                                                                   | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPDevice::GetPowerSource**](/windows/win32/mswmdm/nf-mswmdm-imdspdevice-getpowersource?branch=master)                                                                     | Optional.                                                                                                                                                                                                                                          |
| [**IMDSPDevice::GetSerialNumber**](/windows/win32/mswmdm/nf-mswmdm-imdspdevice-getserialnumber?branch=master)                                                                   | Optional. For protected content transfer, Windows Media Device Manager uses **IMDSPStorageGlobals::GetSerialNumber**.                                                                                                                              |
| [**IMDSPDevice::GetStatus**](/windows/win32/mswmdm/nf-mswmdm-imdspdevice-getstatus?branch=master)                                                                               | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPDevice::GetType**](/windows/win32/mswmdm/nf-mswmdm-imdspdevice-gettype?branch=master)                                                                                   | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPDevice::GetVersion**](/windows/win32/mswmdm/nf-mswmdm-imdspdevice-getversion?branch=master)                                                                             | Optional.                                                                                                                                                                                                                                          |
| [**IMDSPDevice::SendOpaqueCommand**](/windows/win32/mswmdm/nf-mswmdm-imdspdevice-sendopaquecommand?branch=master)                                                               | Optional.                                                                                                                                                                                                                                          |
| [**IMDSPDevice2::GetCanonicalName**](/windows/win32/mswmdm/nf-mswmdm-imdspdevice2-getcanonicalname?branch=master)                                                               | Optional.                                                                                                                                                                                                                                          |
| [**IMDSPDevice2::GetFormatSupport2**](/windows/win32/mswmdm/nf-mswmdm-imdspdevice2-getformatsupport2?branch=master)                                                             | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPDevice2::GetSpecifyPropertyPages**](/windows/win32/mswmdm/nf-mswmdm-imdspdevice2-getspecifypropertypages?branch=master)                                                 | Optional.                                                                                                                                                                                                                                          |
| [**IMDSPDevice2::GetStorage**](/windows/win32/mswmdm/nf-mswmdm-imdspdevice2-getstorage?branch=master)                                                                           | Optional.                                                                                                                                                                                                                                          |
| [**IMDSPDeviceControl Interface**](/windows/win32/mswmdm/nn-mswmdm-imdspdevicecontrol?branch=master)                                                                            | Optional.                                                                                                                                                                                                                                          |
| [**IMDSPEnumDevice::Clone**](/windows/win32/mswmdm/nf-mswmdm-imdspenumdevice-clone?branch=master)                                                                               | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPEnumDevice::Next**](/windows/win32/mswmdm/nf-mswmdm-imdspenumdevice-next?branch=master)                                                                                 | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPEnumDevice::Reset**](/windows/win32/mswmdm/nf-mswmdm-imdspenumdevice-reset?branch=master)                                                                               | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPEnumDevice::Skip**](/windows/win32/mswmdm/nf-mswmdm-imdspenumdevice-skip?branch=master)                                                                                 | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPEnumStorage::Clone**](/windows/win32/mswmdm/nf-mswmdm-imdspenumstorage-clone?branch=master)                                                                             | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPEnumStorage::Next**](/windows/win32/mswmdm/nf-mswmdm-imdspenumstorage-next?branch=master)                                                                               | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPEnumStorage::Reset**](/windows/win32/mswmdm/nf-mswmdm-imdspenumstorage-reset?branch=master)                                                                             | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPEnumStorage::Skip**](/windows/win32/mswmdm/nf-mswmdm-imdspenumstorage-skip?branch=master)                                                                               | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPObject::Close**](/windows/win32/mswmdm/nf-mswmdm-imdspobject-close?branch=master)                                                                                       | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPObject::Delete**](/windows/win32/mswmdm/nf-mswmdm-imdspobject-delete?branch=master)                                                                                     | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPObject::Move**](/windows/win32/mswmdm/nf-mswmdm-imdspobject-move?branch=master)                                                                                         | Optional.                                                                                                                                                                                                                                          |
| [**IMDSPObject::Open**](/windows/win32/mswmdm/nf-mswmdm-imdspobject-open?branch=master)                                                                                         | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPObject::Read**](/windows/win32/mswmdm/nf-mswmdm-imdspobject-read?branch=master)                                                                                         | Mandatory (if Windows Media Player support is desired).                                                                                                                                                                                            |
| [**IMDSPObject::Rename**](/windows/win32/mswmdm/nf-mswmdm-imdspobject-rename?branch=master)                                                                                     | Optional.                                                                                                                                                                                                                                          |
| [**IMDSPObject::Seek**](/windows/win32/mswmdm/nf-mswmdm-imdspobject-seek?branch=master)                                                                                         | Optional.                                                                                                                                                                                                                                          |
| [**IMDSPObject::Write**](/windows/win32/mswmdm/nf-mswmdm-imdspobject-write?branch=master)                                                                                       | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPObjectInfo Interface**](/windows/win32/mswmdm/nn-mswmdm-imdspobjectinfo?branch=master)                                                                                  | Optional.                                                                                                                                                                                                                                          |
| [**IMDSPRevoked Interface**](/windows/win32/mswmdm/nn-mswmdm-imdsprevoked?branch=master)                                                                                        | Optional.                                                                                                                                                                                                                                          |
| [**IMDSPStorage::CreateStorage**](/windows/win32/mswmdm/nf-mswmdm-imdspstorage-createstorage?branch=master)                                                                     | Mandatory only if *dwAttributes* is WMDM\_FILE\_ATTR\_FILE.                                                                                                                                                                                        |
| [**IMDSPStorage::EnumStorage**](/windows/win32/mswmdm/nf-mswmdm-imdspstorage-enumstorage?branch=master)                                                                         | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorage::GetAttributes**](/windows/win32/mswmdm/nf-mswmdm-imdspstorage-getattributes?branch=master)                                                                     | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorage::GetDate**](/windows/win32/mswmdm/nf-mswmdm-imdspstorage-getdate?branch=master)                                                                                 | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorage::GetName**](/windows/win32/mswmdm/nf-mswmdm-imdspstorage-getname?branch=master)                                                                                 | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorage::GetRights**](/windows/win32/mswmdm/nf-mswmdm-imdspstorage-getrights?branch=master)                                                                             | Optional.                                                                                                                                                                                                                                          |
| [**IMDSPStorage::GetSize**](/windows/win32/mswmdm/nf-mswmdm-imdspstorage-getsize?branch=master)                                                                                 | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorage::GetStorageGlobals**](/windows/win32/mswmdm/nf-mswmdm-imdspstorage-getstorageglobals?branch=master)                                                             | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorage::SendOpaqueCommands**](/windows/win32/mswmdm/nf-mswmdm-imdspstorage-sendopaquecommand?branch=master)                                                           | Optional.                                                                                                                                                                                                                                          |
| [**IMDSPStorage::SetAttributes**](/windows/win32/mswmdm/nf-mswmdm-imdspstorage-setattributes?branch=master)                                                                     | Optional.                                                                                                                                                                                                                                          |
| [**IMDSPStorage2::CreateStorage2**](/windows/win32/mswmdm/nf-mswmdm-imdspstorage2-createstorage2?branch=master)                                                                 | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorage2::GetAttributes2**](/windows/win32/mswmdm/nf-mswmdm-imdspstorage2-getattributes2?branch=master)                                                                 | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorage2::GetStorage**](/windows/win32/mswmdm/nf-mswmdm-imdspstorage2-getstorage?branch=master)                                                                         | Optional.                                                                                                                                                                                                                                          |
| [**IMDSPStorage2::SetAttributes2**](/windows/win32/mswmdm/nf-mswmdm-imdspstorage2-setattributes2?branch=master)                                                                 | Optional.                                                                                                                                                                                                                                          |
| [**IMDSPStorage3 Interface**](/windows/win32/mswmdm/nn-mswmdm-imdspstorage3?branch=master)                                                                                      | Optional. However, if the device parameter *UseMetadataViews* is set to 1, this interface must be implemented, and **IMDSPStorage3::GetMetadata** becomes mandatory, although **IMDSPStorage3::SetMetadata** is still optional.                    |
| [**IMDSPStorageGlobals::GetCapabilities**](/windows/win32/mswmdm/nf-mswmdm-imdspstorageglobals-getcapabilities?branch=master)                                                   | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorageGlobals::GetDevice**](/windows/win32/mswmdm/nf-mswmdm-imdspstorageglobals-getdevice?branch=master)                                                               | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorageGlobals::GetRootStorage**](/windows/win32/mswmdm/nf-mswmdm-imdspstorageglobals-getrootstorage?branch=master)                                                     | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorageGlobals::GetSerialNumber**](/windows/win32/mswmdm/nf-mswmdm-imdspstorageglobals-getserialnumber?branch=master)                                                   | Mandatory for PDDRM only. Optional otherwise.                                                                                                                                                                                                      |
| [**IMDSPStorageGlobals::GetStatus**](/windows/win32/mswmdm/nf-mswmdm-imdspstorageglobals-getstatus?branch=master)                                                               | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorageGlobals::GetTotalBad**](/windows/win32/mswmdm/nf-mswmdm-imdspstorageglobals-gettotalbad?branch=master)                                                           | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorageGlobals::GetTotalFree**](/windows/win32/mswmdm/nf-mswmdm-imdspstorageglobals-gettotalfree?branch=master)                                                         | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorageGlobals::GetTotalSize**](/windows/win32/mswmdm/nf-mswmdm-imdspstorageglobals-gettotalsize?branch=master)                                                         | Mandatory.                                                                                                                                                                                                                                         |
| [**IMDSPStorageGlobals::Initialize**](/windows/win32/mswmdm/nf-mswmdm-imdspstorageglobals-initialize?branch=master)                                                             | Optional. This method should be implemented if the device supports this functionality. If this method is not implemented, **IMDSPStorageGlobals::GetCapabilites** must return WMDM\_STORAGECAP\_NOT\_INITIALIZABLE in addition to any other flags. |
| [**IMDSPDevice3**](/windows/win32/mswmdm/nn-mswmdm-imdspdevice3?branch=master)[**IMDSPObject2**](/windows/win32/mswmdm/nn-mswmdm-imdspobject2?branch=master)<br/> [**IMDSPStorage4**](/windows/win32/mswmdm/nn-mswmdm-imdspstorage4?branch=master)<br/> | Required to support automatic synchronization with Windows Media Player                                                                                                                                                                            |



 

## Related topics

<dl> <dt>

[**Creating a Service Provider**](creating-a-service-provider.md)
</dt> </dl>

 

 





