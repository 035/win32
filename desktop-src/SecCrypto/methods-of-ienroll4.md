---
Description: The following methods are defined by the IEnroll4 interface or are methods the IEnroll4 interface inherits from IEnroll and IEnroll2.
ms.assetid: e4107c7b-3ec6-4a4b-bf18-13a082221f67
title: Methods of IEnroll4
ms.date: 05/31/2018
ms.topic: article
ms.author: windowssdkdev
ms.prod: windows
ms.technology: desktop
---

# Methods of IEnroll4

The following methods are defined by the [**IEnroll4**](/windows/win32/Xenroll/nn-xenroll-ienroll4?branch=master) interface or are methods the **IEnroll4** interface inherits from [**IEnroll**](/windows/win32/Xenroll/nn-xenroll-ienroll?branch=master) and [**IEnroll2**](/windows/win32/Xenroll/nn-xenroll-ienroll2?branch=master). The property access methods are not shown here. To see the properties for **IEnroll4**, see [Properties of IEnroll4](properties-of-ienroll4.md).



| Method                                                                                                | Description                                                                                                                                                                                                                                                                                           |
|-------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**acceptFilePKCS7WStr**](/windows/win32/Xenroll/nf-xenroll-ienroll-acceptfilepkcs7wstr?branch=master)                                           | Accepts and processes a PKCS \#7 message containing a certificate, then stores the message to a file.                                                                                                                                                                                                 |
| [**acceptFileResponseWStr**](/windows/win32/Xenroll/nf-xenroll-ienroll4-acceptfileresponsewstr?branch=master)                                     | Accepts delivery of the credentials issued in response to an earlier call to [**createFileRequestWStr**](/windows/win32/Xenroll/nf-xenroll-ienroll4-createfilerequestwstr?branch=master) and places the credentials in the appropriate store.                                                                                                     |
| [**acceptPKCS7Blob**](/windows/win32/Xenroll/nf-xenroll-ienroll-acceptpkcs7blob?branch=master)                                                   | Accepts and processes a PKCS \#7 message containing a certificate. The PKCS \#7 is input as a parameter.                                                                                                                                                                                              |
| [**acceptResponseBlob**](/windows/win32/Xenroll/nf-xenroll-ienroll4-acceptresponseblob?branch=master)                                             | Accepts delivery of the credentials issued in response to an earlier call to [**IEnroll4::createRequestWStr**](/windows/win32/Xenroll/nf-xenroll-ienroll4-createrequestwstr?branch=master) and places the credentials in the appropriate store.                                                                                                   |
| [**addAttributeToRequestWStr**](/windows/win32/Xenroll/nf-xenroll-ienroll4-addattributetorequestwstr?branch=master)                               | Adds an attribute to the certificate request.                                                                                                                                                                                                                                                         |
| [**AddAuthenticatedAttributesToPKCS7Request**](/windows/win32/Xenroll/nf-xenroll-ienroll-addauthenticatedattributestopkcs7request?branch=master) | Adds authenticated attributes to a PKCS \#7 certificate request.                                                                                                                                                                                                                                      |
| [**addBlobPropertyToCertificateWStr**](/windows/win32/Xenroll/nf-xenroll-ienroll4-addblobpropertytocertificatewstr?branch=master)                 | Adds a BLOB property to a certificate.                                                                                                                                                                                                                                                                |
| [**AddCertTypeToRequestWStr**](/windows/win32/Xenroll/nf-xenroll-ienroll-addcerttypetorequestwstr?branch=master)                                 | Adds a certificate template to a request (used to support the enterprise certification authority (CA)).                                                                                                                                                                                               |
| [**AddCertTypeToRequestWStrEx**](/windows/win32/Xenroll/nf-xenroll-ienroll4-addcerttypetorequestwstrex?branch=master)                             | Adds a certificate template (or "certificate type") to a request.                                                                                                                                                                                                                                     |
| [**AddExtensionsToRequest**](/windows/win32/Xenroll/nf-xenroll-ienroll-addextensionstorequest?branch=master)                                     | Adds extensions to the certificate request.                                                                                                                                                                                                                                                           |
| [**addExtensionToRequestWStr**](/windows/win32/Xenroll/nf-xenroll-ienroll4-addextensiontorequestwstr?branch=master)                               | Adds an extension to the request.                                                                                                                                                                                                                                                                     |
| [**addNameValuePairToRequestWStr**](/windows/win32/Xenroll/?branch=master)                       | Adds a name-value string pair to the request.                                                                                                                                                                                                                                                         |
| [**AddNameValuePairToSignatureWStr**](/windows/win32/Xenroll/?branch=master)                   | Adds the name and value pair of an attribute to the request. It is up to the CA to interpret the meaning of the name-value pair.                                                                                                                                                                      |
| [**binaryBlobToString**](/windows/win32/Xenroll/nf-xenroll-ienroll4-binaryblobtostring?branch=master)                                             | Converts a binary data BLOB to a string.                                                                                                                                                                                                                                                              |
| [**createFilePFXWStr**](/windows/win32/Xenroll/nf-xenroll-ienroll4-createfilepfxwstr?branch=master)                                               | Saves the accepted certificate chain and private key in a file in PFX format.                                                                                                                                                                                                                         |
| [**createFilePKCS10WStr**](/windows/win32/Xenroll/nf-xenroll-ienroll-createfilepkcs10wstr?branch=master)                                         | Creates a base64-encoded PKCS \#10 certificate request and saves it in a file.                                                                                                                                                                                                                        |
| [**createFileRequestWStr**](/windows/win32/Xenroll/nf-xenroll-ienroll4-createfilerequestwstr?branch=master)                                       | Creates a PKCS \#10 certificate request, a PKCS \#7 request, or a Full CMC certificate request and stores it in a file.                                                                                                                                                                               |
| [**createPFXWStr**](/windows/win32/Xenroll/nf-xenroll-ienroll4-createpfxwstr?branch=master)                                                       | Saves the accepted certificate chain and private key in a Personal Information Exchange (PFX) format string. The PFX format is also known as PKCS \#12.                                                                                                                                               |
| [**createPKCS10WStr**](/windows/win32/Xenroll/nf-xenroll-ienroll-createpkcs10wstr?branch=master)                                                 | Creates a base64-encoded PKCS \#10 certificate request.                                                                                                                                                                                                                                               |
| [**CreatePKCS7RequestFromRequest**](/windows/win32/Xenroll/?branch=master)                       | Creates a PKCS \#7 request from an existing certificate request.                                                                                                                                                                                                                                      |
| [**createRequestWStr**](/windows/win32/Xenroll/nf-xenroll-ienroll4-createrequestwstr?branch=master)                                               | Creates a PKCS \#10, PKCS \#7, or Full CMC format certificate request and stores it in a string.                                                                                                                                                                                                      |
| [**EnumAlgs**](/windows/win32/Xenroll/nf-xenroll-ienroll2-enumalgs?branch=master)                                                                 | Retrieves the IDs of cryptographic algorithms in a given algorithm class that are supported by the current CSP.                                                                                                                                                                                       |
| [**enumContainersWStr**](/windows/win32/Xenroll/nf-xenroll-ienroll-enumcontainerswstr?branch=master)                                             | Retrieves the names of the containers for the CSP specified by the [**ProviderNameWStr**](/windows/win32/Xenroll/nf-xenroll-ienroll-get_providernamewstr?branch=master) property.                                                                                                                                                                    |
| [**enumPendingRequestWStr**](/windows/win32/Xenroll/nf-xenroll-ienroll4-enumpendingrequestwstr?branch=master)                                     | Enumerates pending certificate requests and retrieves a specified property from each.                                                                                                                                                                                                                 |
| [**enumProvidersWStr**](/windows/win32/Xenroll/nf-xenroll-ienroll-enumproviderswstr?branch=master)                                               | Retrieves the names of the available cryptographic service providers (CSPs) specified by the [**ProviderType**](/windows/win32/Xenroll/nf-xenroll-ienroll-get_providertype?branch=master) property.                                                                                                                                                  |
| [**freeRequestInfoBlob**](/windows/win32/Xenroll/nf-xenroll-ienroll-freerequestinfoblob?branch=master)                                           | Deletes a certificate context.                                                                                                                                                                                                                                                                        |
| [**GetAlgNameWStr**](/windows/win32/Xenroll/nf-xenroll-ienroll2-getalgnamewstr?branch=master)                                                     | Retrieves the name of a cryptographic algorithm given its ID. The values retrieved by this method depend on the current CSP.                                                                                                                                                                          |
| [**getCAStore**](/windows/win32/Xenroll/?branch=master)                                                             | Reserved for future use.                                                                                                                                                                                                                                                                              |
| [**getCertContextFromFileResponseWStr**](/windows/win32/Xenroll/nf-xenroll-ienroll4-getcertcontextfromfileresponsewstr?branch=master)             | Retrieves the certificate from a file containing a response from a CA.                                                                                                                                                                                                                                |
| [**getCertContextFromPKCS7**](/windows/win32/Xenroll/?branch=master)                                   | Retrieves the certificate, contained in a PKCS \#7 message, that was issued in response to a PKCS \#10 certificate request.                                                                                                                                                                           |
| [**getCertContextFromResponseBlob**](/windows/win32/Xenroll/nf-xenroll-ienroll4-getcertcontextfromresponseblob?branch=master)                     | Retrieves the certificate from a CA's response.                                                                                                                                                                                                                                                       |
| [**GetKeyLen**](/windows/win32/Xenroll/nf-xenroll-ienroll2-getkeylen?branch=master)                                                               | Retrieves the minimum and maximum key lengths for the signature and exchange keys.                                                                                                                                                                                                                    |
| [**GetKeyLenEx**](/windows/win32/Xenroll/nf-xenroll-ienroll4-getkeylenex?branch=master)                                                           | Retrieves size information for the signature and exchange keys.                                                                                                                                                                                                                                       |
| [**getMyStore**](/windows/win32/Xenroll/?branch=master)                                                             | Reserved for future use.                                                                                                                                                                                                                                                                              |
| [**GetPrivateKeyArchiveCertificate**](/windows/win32/Xenroll/nf-xenroll-ienroll4-getprivatekeyarchivecertificate?branch=master)                   | Retrieves the certificate used to archive the private key.                                                                                                                                                                                                                                            |
| [**getProviderTypeWStr**](/windows/win32/Xenroll/nf-xenroll-ienroll4-getprovidertypewstr?branch=master)                                           | Retrieves the type of the specified CSP.                                                                                                                                                                                                                                                              |
| [**getROOTHStore**](/windows/win32/Xenroll/?branch=master)                                                       | Reserved for future use.                                                                                                                                                                                                                                                                              |
| [**GetSupportedKeySpec**](/windows/win32/Xenroll/nf-xenroll-ienroll2-getsupportedkeyspec?branch=master)                                           | Retrieves information regarding the CSP's support for signature or exchange keys.                                                                                                                                                                                                                     |
| [**InstallPKCS7Blob**](/windows/win32/Xenroll/nf-xenroll-ienroll2-installpkcs7blob?branch=master)                                                 | Processes a certificate or chain of certificates, placing them into the appropriate certificate stores. This method differs from the [**acceptPKCS7Blob**](/windows/win32/Xenroll/nf-xenroll-ienroll-acceptpkcs7blob?branch=master) method in that [**InstallPKCS7Blob**](/windows/win32/Xenroll/nf-xenroll-ienroll2-installpkcs7blob?branch=master) does not receive a request certificate. |
| [**InstallPKCS7BlobEx**](/windows/win32/Xenroll/nf-xenroll-ienroll4-installpkcs7blobex?branch=master)                                             | Extends [**InstallPKCS7Blob**](/windows/win32/Xenroll/nf-xenroll-ienroll2-installpkcs7blob?branch=master) by returning the number of certificates actually installed in local stores.                                                                                                                                                             |
| [**removePendingRequestWStr**](/windows/win32/Xenroll/nf-xenroll-ienroll4-removependingrequestwstr?branch=master)                                 | Removes a pending request from the client's request store.                                                                                                                                                                                                                                            |
| [**Reset**](/windows/win32/Xenroll/?branch=master)                                                                       | Returns the certificate enrollment control object to its initial state.                                                                                                                                                                                                                               |
| [**resetAttributes**](/windows/win32/Xenroll/nf-xenroll-ienroll4-resetattributes?branch=master)                                                   | Removes all attributes from the request.                                                                                                                                                                                                                                                              |
| [**resetExtensions**](/windows/win32/Xenroll/nf-xenroll-ienroll4-resetextensions?branch=master)                                                   | Removes all extensions from the request.                                                                                                                                                                                                                                                              |
| [**SetHStoreCA**](/windows/win32/Xenroll/nf-xenroll-ienroll2-sethstoreca?branch=master)                                                           | Specifies the handle to use for the CA store.                                                                                                                                                                                                                                                         |
| [**SetHStoreMy**](/windows/win32/Xenroll/?branch=master)                                                           | Specifies the handle to use for the MY store.                                                                                                                                                                                                                                                         |
| [**SetHStoreRequest**](/windows/win32/Xenroll/nf-xenroll-ienroll2-sethstorerequest?branch=master)                                                 | Specifies the handle to use for the request store.                                                                                                                                                                                                                                                    |
| [**SetHStoreROOT**](/windows/win32/Xenroll/nf-xenroll-ienroll2-sethstoreroot?branch=master)                                                       | Specifies the handle to use for the ROOT store.                                                                                                                                                                                                                                                       |
| [**setPendingRequestInfoWStr**](/windows/win32/Xenroll/nf-xenroll-ienroll4-setpendingrequestinfowstr?branch=master)                               | Sets properties for a pending request.                                                                                                                                                                                                                                                                |
| [**SetPrivateKeyArchiveCertificate**](/windows/win32/Xenroll/nf-xenroll-ienroll4-setprivatekeyarchivecertificate?branch=master)                   | Specifies the certificate used to archive the private key.                                                                                                                                                                                                                                            |
| [**SetSignerCertificate**](/windows/win32/Xenroll/nf-xenroll-ienroll4-setsignercertificate?branch=master)                                         | Specifies the signer's certificate.                                                                                                                                                                                                                                                                   |
| [**stringToBinaryBlob**](/windows/win32/Xenroll/nf-xenroll-ienroll4-stringtobinaryblob?branch=master)                                             | Converts a string to a binary data BLOB.                                                                                                                                                                                                                                                              |



 

 

 



