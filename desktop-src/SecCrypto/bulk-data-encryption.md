---
Description: A bulk encryption key is generated by hashing one of the MAC keys using CryptHashSessionKey together with the message contents and other data. The message is encrypted/decrypted with one of the bulk encryption keys in the usual manner.
ms.assetid: 08174502-3ff1-4c1c-bcd0-46fd85882305
title: Bulk Data Encryption
ms.technology: desktop
ms.prod: windows
ms.author: windowssdkdev
ms.topic: article
ms.date: 05/31/2018
---

# Bulk Data Encryption

A [*bulk encryption key*](https://msdn.microsoft.com/2e570727-7da0-4e17-bf5d-6fe0e6aef65b) is generated by [*hashing*](https://msdn.microsoft.com/4165b820-30fc-477e-a690-81109f161323) one of the MAC keys using [**CryptHashSessionKey**](/windows/desktop/api/Wincrypt/nf-wincrypt-crypthashsessionkey) together with the message contents and other data. The message is encrypted/decrypted with one of the bulk encryption keys in the usual manner.

When using a [*block cipher*](https://msdn.microsoft.com/2e570727-7da0-4e17-bf5d-6fe0e6aef65b), the [*Schannel*](https://msdn.microsoft.com/3e9d7672-2314-45c8-8178-5a0afcfd0c50) protocol engine does all necessary *block cipher* [*padding*](https://msdn.microsoft.com/2fe6cfd3-8a2e-4dbe-9fb8-332633daa97a). When [**CryptEncrypt**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencrypt) and [**CryptDecrypt**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdecrypt) are called, the Final flag is always **FALSE** and the data length is a multiple of whole block lengths.

> [!Note]  
> The CSP must never buffer data internally. After the data has been encrypted (or decrypted), the size of the [*plaintext*](https://msdn.microsoft.com/2fe6cfd3-8a2e-4dbe-9fb8-332633daa97a) must always exactly match the size of the [*ciphertext*](https://msdn.microsoft.com/db46def4-bfdc-4801-a57d-d568e94a2dbb).

 

 

 



