---
Description: A bulk encryption key is generated by hashing one of the MAC keys using CryptHashSessionKey together with the message contents and other data. The message is encrypted/decrypted with one of the bulk encryption keys in the usual manner.
ms.assetid: 08174502-3ff1-4c1c-bcd0-46fd85882305
title: Bulk Data Encryption
ms.date: 05/31/2018
ms.topic: article
ms.author: windowssdkdev
ms.prod: windows
ms.technology: desktop
---

# Bulk Data Encryption

A [*bulk encryption key*](security.b_gly#-security-bulk-encryption-key-gly) is generated by [*hashing*](security.h_gly#-security-hash-gly) one of the MAC keys using [**CryptHashSessionKey**](/windows/win32/Wincrypt/nf-wincrypt-crypthashsessionkey?branch=master) together with the message contents and other data. The message is encrypted/decrypted with one of the bulk encryption keys in the usual manner.

When using a [*block cipher*](security.b_gly#-security-block-cipher-gly), the [*Schannel*](security.s_gly#-security-schannel-gly) protocol engine does all necessary *block cipher* [*padding*](security.p_gly#-security-padding-gly). When [**CryptEncrypt**](/windows/win32/Wincrypt/nf-wincrypt-cryptencrypt?branch=master) and [**CryptDecrypt**](/windows/win32/Wincrypt/nf-wincrypt-cryptdecrypt?branch=master) are called, the Final flag is always **FALSE** and the data length is a multiple of whole block lengths.

> [!Note]  
> The CSP must never buffer data internally. After the data has been encrypted (or decrypted), the size of the [*plaintext*](security.p_gly#-security-plaintext-gly) must always exactly match the size of the [*ciphertext*](security.c_gly#-security-ciphertext-gly).

 

 

 



