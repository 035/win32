---
title: Managed Reference for Windows Server Backup PowerShell Command Classes
description: Windows Server Backup can use Windows PowerShell cmdlets to create and manage backups in Windows Server 2008 R2.
audience: developer
author: REDMOND\\markl
manager: REDMOND\\markl
ms.assetid: '78A51D65-518E-458A-9CE7-BBEC7273FEFC'
ms.prod: 'windows-server-dev'
ms.technology: 'windows-server-backup'
ms.tgt_platform: multiple
---

# Managed Reference for Windows Server Backup PowerShell Command Classes

[Windows Server Backup](http://go.microsoft.com/fwlink/p/?linkid=111182) can use Windows PowerShell cmdlets to create and manage backups in Windows Server 2008 R2. This topic describes the following elements:

-   [WSB PowerShell Classes](#wsb-powershell-classes)
-   [WSB Enumerations](#wsb-enumerations)

## WSB PowerShell Classes

**Namespace**: Microsoft.Windows.ServerBackup.Commands

**DLL**: wsbcmdlet.dll

The following [Windows Server Backup](http://go.microsoft.com/fwlink/p/?linkid=111182) command classes are implemented by Windows PowerShell. These classes are included in this software development kit (SDK) for completeness only. The members of these classes cannot be used directly nor should they be used to derive other classes.



| Class                                       | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|---------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| AddWBBackupTargetCommand<br/>         | Adds the WBBackupTarget object, which specifies backup storage locations, to the backup policy (WBPolicy object). <br/> For detailed information about the parameters and for examples, see the [Add-WBBackupTarget](http://go.microsoft.com/fwlink/p/?linkid=201956) cmdlet. <br/>                                                                                                                                                                                                                                                                                        |
| AddWBBareMetalRecoveryCommand<br/>    | Adds the needed items to the backup policy to enable you to perform a bare metal recovery (BMR) later with backups created using that policy. <br/> For detailed information about the parameters and for examples, see the [Add-WBBareMetalRecovery](http://go.microsoft.com/fwlink/p/?linkid=201958) cmdlet. <br/>                                                                                                                                                                                                                                                       |
| AddWBFileSpecCommand<br/>             | Adds the WBFileSpec object, which specifies the items to include or exclude from a backup, to the backup policy. <br/> For detailed information about the parameters and for examples, see the [Add-WBFileSpec](http://go.microsoft.com/fwlink/p/?linkid=201959) cmdlet. <br/>                                                                                                                                                                                                                                                                                             |
| AddWBSystemStateCommand<br/>          | Adds the items needed to the backup policy, so that later you can use backups created with this policy to perform a system state recovery. <br/> For detailed information about the parameters and for examples, see the [Add-WBSystemState](http://go.microsoft.com/fwlink/p/?linkid=201960) cmdlet. <br/>                                                                                                                                                                                                                                                                |
| AddWBVolumeCommand<br/>               | Adds the list of source volumes to the backup policy. <br/> For detailed information about the parameters and for examples, see the [Add-WBVolume](http://go.microsoft.com/fwlink/p/?linkid=201961) cmdlet. <br/>                                                                                                                                                                                                                                                                                                                                                          |
| GetWBBackupSetCommand<br/>            | Gets the list of backups (WBBackupSet objects) that were created for a server and stored at a location that you specified. <br/> For detailed information about the parameters and for examples, see the [Get-WBBackupSet](http://go.microsoft.com/fwlink/p/?linkid=201962) cmdlet. <br/>                                                                                                                                                                                                                                                                                  |
| GetWBBackupTargetCommand<br/>         | Gets the locations for storing backups that you specified as part of the backup policy. <br/> For detailed information about the parameters and for examples, see the [Get-WBBackupTarget](http://go.microsoft.com/fwlink/p/?linkid=201963) cmdlet. <br/>                                                                                                                                                                                                                                                                                                                  |
| GetWBBareMetalRecoveryCommand<br/>    | Gets the value that indicates whether the ability to perform BMRs from backups has been added to the backup policy. <br/> For detailed information about the parameters and for examples, see the [Get-WBBareMetalRecovery](http://go.microsoft.com/fwlink/p/?linkid=201965) cmdlet. <br/>                                                                                                                                                                                                                                                                                 |
| GetWBDiskCommand<br/>                 | Gets the list of internal and external disks that are online for the local computer. <br/> For detailed information about the parameters and for examples, see the [Get-WBDisk](http://go.microsoft.com/fwlink/p/?linkid=201966) cmdlet. <br/>                                                                                                                                                                                                                                                                                                                             |
| GetWBFileSpecCommand<br/>             | Gets the list of WBFileSpec objects that are associated with the specified backup policy. <br/> For detailed information about the parameters and for examples, see the [Get-WBFileSpec](http://go.microsoft.com/fwlink/p/?linkid=201967) cmdlet. <br/>                                                                                                                                                                                                                                                                                                                    |
| GetWBJobCommand<br/>                  | Gets the operation that is running (WBJob object). <br/> For detailed information about the parameters and for examples, see the [Get-WBJob](http://go.microsoft.com/fwlink/p/?linkid=201968) cmdlet. <br/>                                                                                                                                                                                                                                                                                                                                                                |
| GetWBPolicyCommand<br/>               | Gets the current backup policy that is set for the computer. <br/> For detailed information about the parameters and for examples, see the [Get-WBPolicy](http://go.microsoft.com/fwlink/p/?linkid=201970) cmdlet. <br/>                                                                                                                                                                                                                                                                                                                                                   |
| GetWBScheduleCommand<br/>             | Gets the current schedule for backups in the backup policy. <br/> For detailed information about the parameters and for examples, see the [Get-WBSchedule](http://go.microsoft.com/fwlink/p/?linkid=201972) cmdlet. <br/>                                                                                                                                                                                                                                                                                                                                                  |
| GetWBSummaryCommand<br/>              | Gets the history of the backup operations performed. <br/> For detailed information about the parameters and for examples, see the [Get-WBSummary](http://go.microsoft.com/fwlink/p/?linkid=201973) cmdlet. <br/>                                                                                                                                                                                                                                                                                                                                                          |
| GetWBSystemStateCommand<br/>          | Gets a Boolean value that indicates whether the ability to perform system state recoveries with the backups has been added to the backup policy. <br/> For detailed information about the parameters and for examples, see the [Get-WBSystemState](http://go.microsoft.com/fwlink/p/?linkid=201974) cmdlet. <br/>                                                                                                                                                                                                                                                          |
| GetWBVolumeCommand<br/>               | Gets the list of source volumes for the backup that is included in the backup policy. <br/> For detailed information about the parameters and for examples, see the [Get-WBVolume](http://go.microsoft.com/fwlink/p/?linkid=201975) cmdlet. <br/>                                                                                                                                                                                                                                                                                                                          |
| GetWBVssBackupOptionsCommand<br/>     | Gets a setting that specifies whether the backups created using the backup policy will be Volume Shadow Copy Service (VSS) copy backups or VSS full backups. <br/> For detailed information about the parameters and for examples, see the [Get-WBVssBackupOptions](http://go.microsoft.com/fwlink/p/?linkid=201976) cmdlet. <br/>                                                                                                                                                                                                                                         |
| NewWBBackupTargetCommand<br/>         | Creates a WBBackupTarget object. <br/> For detailed information about the parameters and for examples, see the [New-WBBackupTarget](http://go.microsoft.com/fwlink/p/?linkid=201977) cmdlet. <br/>                                                                                                                                                                                                                                                                                                                                                                         |
| NewWBFileSpecCommand<br/>             | Creates a WBFileSpec object. <br/> For detailed information about the parameters and for examples, see the [New-WBFileSpec](http://go.microsoft.com/fwlink/p/?linkid=201978) cmdlet. <br/>                                                                                                                                                                                                                                                                                                                                                                                 |
| NewWBPolicyCommand<br/>               | Creates a WBPolicy object. <br/> For detailed information about the parameters and for examples, see the [New-WBPolicy](http://go.microsoft.com/fwlink/p/?linkid=201979) cmdlet. <br/>                                                                                                                                                                                                                                                                                                                                                                                     |
| RemoveWBBackupTargetCommand<br/>      | Removes the backup storage locations (defined by the WBBackupTarget object) from the backup policy. <br/> For detailed information about the parameters and for examples, see the [Remove-WBBackupTarget](http://go.microsoft.com/fwlink/p/?linkid=201980) cmdlet. <br/>                                                                                                                                                                                                                                                                                                   |
| RemoveWBBareMetalRecoveryCommand<br/> | Removes the request to include all items needed for a BMR from the current backup policy. <br/> For detailed information about the parameters and for examples, see the [Remove-WBBareMetalRecovery](http://go.microsoft.com/fwlink/p/?linkid=201981) cmdlet. <br/>                                                                                                                                                                                                                                                                                                        |
| RemoveWBFileSpecCommand<br/>          | Removes the list of items to include or exclude from a backup (as specified by the WBFileSpec object) from a backup policy. <br/> For detailed information about the parameters and for examples, see the [Remove-WBFileSpec](http://go.microsoft.com/fwlink/p/?linkid=201982) cmdlet. <br/>                                                                                                                                                                                                                                                                               |
| RemoveWBPolicyCommand<br/>            | Removes the backup policy that is currently set. <br/> For detailed information about the parameters and for examples, see the [Remove-WBPolicy](http://go.microsoft.com/fwlink/p/?linkid=201983) cmdlet. <br/>                                                                                                                                                                                                                                                                                                                                                            |
| RemoveWBSystemStateCommand<br/>       | Removes the request to include all items needed for a system state recovery from the current backup policy. <br/> For detailed information about the parameters and for examples, see the [Remove-WBSystemState](http://go.microsoft.com/fwlink/p/?linkid=201984) cmdlet. <br/>                                                                                                                                                                                                                                                                                            |
| RemoveWBVolumeCommand<br/>            | Removes the volume to back up (specified by the WBVolume object) from the backup policy. <br/> For detailed information about the parameters and for examples, see the [Remove-WBVolume](http://go.microsoft.com/fwlink/p/?linkid=201985) cmdlet. <br/>                                                                                                                                                                                                                                                                                                                    |
| SetWBPolicyCommand<br/>               | Sets the WBPolicy object as the backup policy that will be used for scheduled backups. <br/> For detailed information about the parameters and for examples, see the [Set-WBPolicy](http://go.microsoft.com/fwlink/p/?linkid=201986) cmdlet. <br/>                                                                                                                                                                                                                                                                                                                         |
| SetWBScheduleCommand<br/>             | Sets the times to create daily backups for the backup policy. <br/> For detailed information about the parameters and for examples, see the [Set-WBSchedule](http://go.microsoft.com/fwlink/p/?linkid=201987) cmdlet. <br/>                                                                                                                                                                                                                                                                                                                                                |
| SetWBVssBackupOptionsCommand<br/>     | Sets a value that specifies whether the backups that are created using the backup policy are VSS copy backups or VSS full backups. <br/> For detailed information about the parameters and for examples, see the [Set-WBVssBackupOptions](http://go.microsoft.com/fwlink/p/?linkid=201988) cmdlet. <br/>                                                                                                                                                                                                                                                                   |
| StartWBBackupCommand<br/>             | Starts a one-time backup operation. <br/> For detailed information about the parameters and for examples, see the [Start-WBBackup](http://go.microsoft.com/fwlink/p/?linkid=201989) cmdlet. <br/>                                                                                                                                                                                                                                                                                                                                                                          |
| WBApplication<br/>                    | The WBApplication object identifies an application that is backed up as part of a volume or BMR backup. It contains the applicationâs identifier, its writer ID, and a list of its components. <br/>                                                                                                                                                                                                                                                                                                                                                                           |
| WBApplicationComponent<br/>           | The WBApplicationComponent object identifies the components that are reported by an application including the component name and the writer ID of the writer it is reporting to. <br/>                                                                                                                                                                                                                                                                                                                                                                                           |
| WBBackupSet<br/>                      | The WBBackupSet object identifies a backup created for a server and is stored at a location that the user specified at the time of the backup. It contains information about backup time and date, the computer that was backed up, the type of backup created, and which items were backed up.<br/>                                                                                                                                                                                                                                                                             |
| WBBackupTarget<br/>                   | The WBBackupTarget object identifies a location for storing backups that can be set as part of the backup policy. Valid locations include disks, volumes, or remote shared folders.<br/> To create WBbackupTarget objects that can be added to the WBPolicy object as backup storage locations, use the [New-WBBackupTarget](http://go.microsoft.com/fwlink/p/?linkid=201977) cmdlet.<br/> The [Get-WBBackupTarget](http://go.microsoft.com/fwlink/p/?linkid=201963) cmdlet retrieves the locations for storing backups specified as part of the backup policy.<br/> |
| WBDisk<br/>                           | The WBDisk object identifies disks that can be added to the backup policy (WBPolicy object) as backup targets.<br/> To specify disks as backup storage locations, use the [New-WBBackupTarget](http://go.microsoft.com/fwlink/p/?linkid=201977) cmdlet.<br/> To retrieve the list of internal and external disks that are online for the local computer, use the [Get-WBDisk](http://go.microsoft.com/fwlink/p/?linkid=201966) cmdlet.<br/>                                                                                                                          |
| WBFileSpec<br/>                       | The WBFileSpec object defines what items will be included or excluded from WSB backups using the WBPolicy.<br/> To define and apply changes to the backup policy, use the [New-WBFileSpec](http://go.microsoft.com/fwlink/p/?linkid=201978) and the [Add-WBFileSpec](http://go.microsoft.com/fwlink/p/?linkid=201959) cmdlets.<br/>                                                                                                                                                                                                                                        |
| WBItem<br/>                           | The WBItem object defines the backup items in a WBJob object. The WBItem inside WBJob can be a single object or a list of other WBItems. To see the list of possible WBItem types, see WBItemType.<br/> To get the currently running or previous backup operation, use the [Get-WBJob](http://go.microsoft.com/fwlink/p/?linkid=201968) cmdlet.<br/>                                                                                                                                                                                                                       |
| WBJob<br/>                            | The WBJob object defines the currently running or previous backup operation. It contains information about the job type, start time, end time, and the state of the operation.<br/>                                                                                                                                                                                                                                                                                                                                                                                              |
| WBPolicy<br/>                         | The WBPolicy object is used to store the backup policy for a computer. It contains information about the volumes included in the policy, files in the backup, the backup target, and scheduled time.<br/>                                                                                                                                                                                                                                                                                                                                                                        |
| WBSummary<br/>                        | The WBSummay object stores a summary of the backup operations performed including information about when the next backup is scheduled, details for the last backup, and details of the last successful backup.<br/> To retrieve the history of backup operations performed, use the [Get-WBSummary](http://go.microsoft.com/fwlink/p/?linkid=201973) cmdlet.<br/>                                                                                                                                                                                                          |
| WBVolume<br/>                         | The WBVolume object stores information about a volume including the volume label, mount path, free space and total space.<br/> To retrieve the list of source volumes for the backup that are included in the backup policy, use the [Get-WBVolume](http://go.microsoft.com/fwlink/p/?linkid=201975) cmdlet.<br/>                                                                                                                                                                                                                                                          |



 

## WSB Enumerations

The following enumerations are used by the WSB classes. These enumerations are included in this SDK for completeness only.



| Enumeration                 | Description                                                                                                                                                                                                                              |
|-----------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| CurrentOperation<br/> | Defines the possible types of a backup operation. The possible types are Backup, Recovery, and No Operation.<br/>                                                                                                                  |
| DiskProperties<br/>   | Defines the possible properties of a Disk (WBDisk object). The possible properties are External, Dynamic, ValidTarget, ContainOemPartition, ContainsCriticalVolume, and None.<br/>                                                 |
| RecoverableItems<br/> | Defines the possible values of recoverable items from a backup (WBBackupset object). The possible values are Volumes, SystemState, Applications, Files, BareMetalRecovery, and None.<br/>                                          |
| TargetType<br/>       | Defines the possible types of a backup target (WBBackuptarget object). The possible types are Volume, Disk, Network, Shiny, and None.<br/>                                                                                         |
| VolumeProperties<br/> | Defines the possible properties a volume (WBVolume object). The possible properties are Critical, ValidSource, ReadOnly, IsExtensibleFirmwareInterfaceSystemPartition, IsOnDynamicDisk, IsOnDiskWithCriticalVolume, and None.<br/> |
| VssBackupOptions<br/> | Defines the possible types of a backup. The possible types are VssCopyBackup and VssFullBackup.<br/>                                                                                                                               |
| WBItemState<br/>      | Defines the possible states of a WBItem object. The possible states are NotStarted, Running, and Completed.<br/>                                                                                                                   |
| WBItemType<br/>       | Defines the possible types of a WBItem object. The possible types are VolumeList, ConsistencyCheck, SystemState, BareMetalRecovery, Volume, Application, Component, ConsistencyCheckResult, and None.<br/>                         |
| WBJobState<br/>       | Defines the possible states of a WBJob object. The possible states are Unknown, NotRunning, Running, and Completed.<br/>                                                                                                           |
| WBJobType<br/>        | Defines the possible types of a WBJob object. The possible types are Backup, Recovery, and None.<br/>                                                                                                                              |



 

 

 





