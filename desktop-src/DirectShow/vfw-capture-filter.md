---
Description: VFW Capture Filter
ms.assetid: 663b6b3b-2a50-4586-9506-600a59869abe
title: VFW Capture Filter
ms.date: 05/31/2018
ms.topic: article
ms.author: windowssdkdev
ms.prod: windows
ms.technology: desktop
---

# VFW Capture Filter

This filter works with older video capture hardware that uses Video For Windows.

This filter has two output pins. One is called Capture, and the other is called either Preview or Overlay.



|                                          |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Filter Interfaces                        | **IPersistPropertyBag**, [**IAMVfwCaptureDialogs**](/windows/win32/Strmif/nn-strmif-iamvfwcapturedialogs?branch=master), [**IAMFilterMiscFlags**](/windows/win32/Strmif/nn-strmif-iamfiltermiscflags?branch=master), [**IBaseFilter**](/windows/win32/Strmif/nn-strmif-ibasefilter?branch=master), **ISpecifyPropertyPages**, [**IOverlayNotify**](/windows/win32/Strmif/nn-strmif-ioverlaynotify?branch=master)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Input Pin Media Types                    | Not applicable.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| Input Pin Interfaces                     | Not applicable.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| Output Pin Media Types                   | Capture: MEDIATYPE\_Video, MEDIASUBTYPE\_NULL, FORMAT\_VideoInfoOverlay: MEDIATYPE\_Video, MEDIASUBTYPE\_Overlay, FORMAT\_VideoInfo<br/> Preview: MEDIATYPE\_Video, MEDIASUBTYPE\_NULL, FORMAT\_VideoInfo<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| Output Pin Interfaces                    | Capture Pin: [**IAMBufferNegotiation**](/windows/win32/Strmif/nn-strmif-iambuffernegotiation?branch=master), [**IAMDroppedFrames**](/windows/win32/Strmif/nn-strmif-iamdroppedframes?branch=master), [**IAMPushSource**](/windows/win32/Strmif/nn-strmif-iampushsource?branch=master), [**IAMStreamConfig**](/windows/win32/Strmif/nn-strmif-iamstreamconfig?branch=master), [**IAMStreamControl**](/windows/win32/Strmif/nn-strmif-iamstreamcontrol?branch=master), [**IAMVideoCompression**](/windows/win32/Strmif/nn-strmif-iamvideocompression?branch=master), [**IKsPropertySet**](ikspropertyset.md), [**IPin**](/windows/win32/Strmif/nn-strmif-ipin?branch=master), [**IQualityControl**](/windows/win32/Strmif/nn-strmif-iqualitycontrol?branch=master)Overlay Pin: [**IAMStreamControl**](/windows/win32/Strmif/nn-strmif-iamstreamcontrol?branch=master), [**IKsPropertySet**](ikspropertyset.md), [**IPin**](/windows/win32/Strmif/nn-strmif-ipin?branch=master), [**IQualityControl**](/windows/win32/Strmif/nn-strmif-iqualitycontrol?branch=master)<br/> Preview Pin: [**IAMPushSource**](/windows/win32/Strmif/nn-strmif-iampushsource?branch=master), [**IAMStreamControl**](/windows/win32/Strmif/nn-strmif-iamstreamcontrol?branch=master), [**IKsPropertySet**](ikspropertyset.md), [**IPin**](/windows/win32/Strmif/nn-strmif-ipin?branch=master), [**IQualityControl**](/windows/win32/Strmif/nn-strmif-iqualitycontrol?branch=master)<br/> |
| Filter CLSID                             | CLSID\_VfwCapture                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| Property Page CLSID                      | CLSID\_CaptureProperties                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Executable                               | qcap.dll                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [Merit](merit.md)                       | MERIT\_DO\_NOT\_USE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [Filter Category](filter-categories.md) | CLSID\_VideoInputDeviceCategory                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |



 

## Remarks

Although the capture pin exposes the [**IAMStreamConfig**](/windows/win32/Strmif/nn-strmif-iamstreamconfig?branch=master) interface, only the **SetFormat** and **GetFormat** methods are implemented for this interface.

## Related topics

<dl> <dt>

[DirectShow Filters](directshow-filters.md)
</dt> <dt>

[Video Capture](video-capture.md)
</dt> </dl>

 

 




